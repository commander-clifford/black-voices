!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).cdpPsmCore={})}(this,function(e){var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},n.exports),n.exports}var r=function(e){return e&&e.Math==Math&&e},i=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof t&&t)||function(){return this}()||Function("return this")(),o=function(e){try{return!!e()}catch(e){return!0}},a=!o(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),s={}.propertyIsEnumerable,c=Object.getOwnPropertyDescriptor,u={f:c&&!s.call({1:2},1)?function(e){var t=c(this,e);return!!t&&t.enumerable}:s},l=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},d={}.toString,f=function(e){return d.call(e).slice(8,-1)},h="".split,p=o(function(){return!Object("z").propertyIsEnumerable(0)})?function(e){return"String"==f(e)?h.call(e,""):Object(e)}:Object,g=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},v=function(e){return p(g(e))},m=function(e){return"object"==typeof e?null!==e:"function"==typeof e},y=function(e,t){if(!m(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!m(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!m(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!m(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")},b=function(e){return Object(g(e))},w={}.hasOwnProperty,S=function(e,t){return w.call(b(e),t)},I=i.document,E=m(I)&&m(I.createElement),T=function(e){return E?I.createElement(e):{}},P=!a&&!o(function(){return 7!=Object.defineProperty(T("div"),"a",{get:function(){return 7}}).a}),_=Object.getOwnPropertyDescriptor,k={f:a?_:function(e,t){if(e=v(e),t=y(t,!0),P)try{return _(e,t)}catch(e){}if(S(e,t))return l(!u.f.call(e,t),e[t])}},A=function(e){if(!m(e))throw TypeError(String(e)+" is not an object");return e},O=Object.defineProperty,C={f:a?O:function(e,t,n){if(A(e),t=y(t,!0),A(n),P)try{return O(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},x=a?function(e,t,n){return C.f(e,t,l(1,n))}:function(e,t,n){return e[t]=n,e},R=function(e,t){try{x(i,e,t)}catch(n){i[e]=t}return t},D=i["__core-js_shared__"]||R("__core-js_shared__",{}),M=Function.toString;"function"!=typeof D.inspectSource&&(D.inspectSource=function(e){return M.call(e)});var N,U,F,L=D.inspectSource,j=i.WeakMap,B="function"==typeof j&&/native code/.test(L(j)),W=n(function(e){(e.exports=function(e,t){return D[e]||(D[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.12.1",mode:"global",copyright:"Â© 2021 Denis Pushkarev (zloirock.ru)"})}),q=0,V=Math.random(),J=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++q+V).toString(36)},z=W("keys"),H=function(e){return z[e]||(z[e]=J(e))},K={};if(B||D.state){var G=D.state||(D.state=new(0,i.WeakMap)),Q=G.get,$=G.has,Y=G.set;N=function(e,t){if($.call(G,e))throw new TypeError("Object already initialized");return t.facade=e,Y.call(G,e,t),t},U=function(e){return Q.call(G,e)||{}},F=function(e){return $.call(G,e)}}else{var X=H("state");K[X]=!0,N=function(e,t){if(S(e,X))throw new TypeError("Object already initialized");return t.facade=e,x(e,X,t),t},U=function(e){return S(e,X)?e[X]:{}},F=function(e){return S(e,X)}}var Z,ee,te={set:N,get:U,has:F,enforce:function(e){return F(e)?U(e):N(e,{})},getterFor:function(e){return function(t){var n;if(!m(t)||(n=U(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}},ne=n(function(e){var t=te.get,n=te.enforce,r=String(String).split("String");(e.exports=function(e,t,o,a){var s,c=!!a&&!!a.unsafe,u=!!a&&!!a.enumerable,l=!!a&&!!a.noTargetGet;"function"==typeof o&&("string"!=typeof t||S(o,"name")||x(o,"name",t),(s=n(o)).source||(s.source=r.join("string"==typeof t?t:""))),e!==i?(c?!l&&e[t]&&(u=!0):delete e[t],u?e[t]=o:x(e,t,o)):u?e[t]=o:R(t,o)})(Function.prototype,"toString",function(){return"function"==typeof this&&t(this).source||L(this)})}),re=i,ie=function(e){return"function"==typeof e?e:void 0},oe=function(e,t){return arguments.length<2?ie(re[e])||ie(i[e]):re[e]&&re[e][t]||i[e]&&i[e][t]},ae=Math.ceil,se=Math.floor,ce=function(e){return isNaN(e=+e)?0:(e>0?se:ae)(e)},ue=Math.min,le=function(e){return e>0?ue(ce(e),9007199254740991):0},de=Math.max,fe=Math.min,he=function(e,t){var n=ce(e);return n<0?de(n+t,0):fe(n,t)},pe=function(e){return function(t,n,r){var i,o=v(t),a=le(o.length),s=he(r,a);if(e&&n!=n){for(;a>s;)if((i=o[s++])!=i)return!0}else for(;a>s;s++)if((e||s in o)&&o[s]===n)return e||s||0;return!e&&-1}},ge={includes:pe(!0),indexOf:pe(!1)},ve=ge.indexOf,me=function(e,t){var n,r=v(e),i=0,o=[];for(n in r)!S(K,n)&&S(r,n)&&o.push(n);for(;t.length>i;)S(r,n=t[i++])&&(~ve(o,n)||o.push(n));return o},ye=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],be=ye.concat("length","prototype"),we={f:Object.getOwnPropertyNames||function(e){return me(e,be)}},Se={f:Object.getOwnPropertySymbols},Ie=oe("Reflect","ownKeys")||function(e){var t=we.f(A(e)),n=Se.f;return n?t.concat(n(e)):t},Ee=function(e,t){for(var n=Ie(t),r=C.f,i=k.f,o=0;o<n.length;o++){var a=n[o];S(e,a)||r(e,a,i(t,a))}},Te=/#|\.prototype\./,Pe=function(e,t){var n=ke[_e(e)];return n==Oe||n!=Ae&&("function"==typeof t?o(t):!!t)},_e=Pe.normalize=function(e){return String(e).replace(Te,".").toLowerCase()},ke=Pe.data={},Ae=Pe.NATIVE="N",Oe=Pe.POLYFILL="P",Ce=Pe,xe=k.f,Re=function(e,t){var n,r,o,a,s,c=e.target,u=e.global,l=e.stat;if(n=u?i:l?i[c]||R(c,{}):(i[c]||{}).prototype)for(r in t){if(a=t[r],o=e.noTargetGet?(s=xe(n,r))&&s.value:n[r],!Ce(u?r:c+(l?".":"#")+r,e.forced)&&void 0!==o){if(typeof a==typeof o)continue;Ee(a,o)}(e.sham||o&&o.sham)&&x(a,"sham",!0),ne(n,r,a,e)}},De=Array.isArray||function(e){return"Array"==f(e)},Me=function(e,t,n){var r=y(t);r in e?C.f(e,r,l(0,n)):e[r]=n},Ne=oe("navigator","userAgent")||"",Ue=i.process,Fe=Ue&&Ue.versions,Le=Fe&&Fe.v8;Le?ee=(Z=Le.split("."))[0]<4?1:Z[0]+Z[1]:Ne&&(!(Z=Ne.match(/Edge\/(\d+)/))||Z[1]>=74)&&(Z=Ne.match(/Chrome\/(\d+)/))&&(ee=Z[1]);var je=ee&&+ee,Be=!!Object.getOwnPropertySymbols&&!o(function(){return!String(Symbol())||!Symbol.sham&&je&&je<41}),We=Be&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,qe=W("wks"),Ve=i.Symbol,Je=We?Ve:Ve&&Ve.withoutSetter||J,ze=function(e){return S(qe,e)&&(Be||"string"==typeof qe[e])||(qe[e]=Be&&S(Ve,e)?Ve[e]:Je("Symbol."+e)),qe[e]},He=ze("species"),Ke=function(e,t){var n;return De(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!De(n.prototype)?m(n)&&null===(n=n[He])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===t?0:t)},Ge=ze("species"),Qe=function(e){return je>=51||!o(function(){var t=[];return(t.constructor={})[Ge]=function(){return{foo:1}},1!==t[e](Boolean).foo})},$e=ze("isConcatSpreadable"),Ye=je>=51||!o(function(){var e=[];return e[$e]=!1,e.concat()[0]!==e}),Xe=Qe("concat"),Ze=function(e){if(!m(e))return!1;var t=e[$e];return void 0!==t?!!t:De(e)};Re({target:"Array",proto:!0,forced:!Ye||!Xe},{concat:function(e){var t,n,r,i,o,a=b(this),s=Ke(a,0),c=0;for(t=-1,r=arguments.length;t<r;t++)if(Ze(o=-1===t?a:arguments[t])){if(c+(i=le(o.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(n=0;n<i;n++,c++)n in o&&Me(s,c,o[n])}else{if(c>=9007199254740991)throw TypeError("Maximum allowed index exceeded");Me(s,c++,o)}return s.length=c,s}});var et=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e},tt=function(e,t,n){if(et(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}},nt=[].push,rt=function(e){var t=1==e,n=2==e,r=3==e,i=4==e,o=6==e,a=7==e,s=5==e||o;return function(c,u,l,d){for(var f,h,g=b(c),v=p(g),m=tt(u,l,3),y=le(v.length),w=0,S=d||Ke,I=t?S(c,y):n||a?S(c,0):void 0;y>w;w++)if((s||w in v)&&(h=m(f=v[w],w,g),e))if(t)I[w]=h;else if(h)switch(e){case 3:return!0;case 5:return f;case 6:return w;case 2:nt.call(I,f)}else switch(e){case 4:return!1;case 7:nt.call(I,f)}return o?-1:r||i?i:I}},it={forEach:rt(0),map:rt(1),filter:rt(2),some:rt(3),every:rt(4),find:rt(5),findIndex:rt(6),filterOut:rt(7)},ot=it.filter,at=Qe("filter");Re({target:"Array",proto:!0,forced:!at},{filter:function(e){return ot(this,e,arguments.length>1?arguments[1]:void 0)}});var st,ct=Object.keys||function(e){return me(e,ye)},ut=a?Object.defineProperties:function(e,t){A(e);for(var n,r=ct(t),i=r.length,o=0;i>o;)C.f(e,n=r[o++],t[n]);return e},lt=oe("document","documentElement"),dt=H("IE_PROTO"),ft=function(){},ht=function(e){return"<script>"+e+"<\/script>"},pt=function(){try{st=document.domain&&new ActiveXObject("htmlfile")}catch(e){}var e,t;pt=st?function(e){e.write(ht("")),e.close();var t=e.parentWindow.Object;return e=null,t}(st):((t=T("iframe")).style.display="none",lt.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(ht("document.F=Object")),e.close(),e.F);for(var n=ye.length;n--;)delete pt.prototype[ye[n]];return pt()};K[dt]=!0;var gt=Object.create||function(e,t){var n;return null!==e?(ft.prototype=A(e),n=new ft,ft.prototype=null,n[dt]=e):n=pt(),void 0===t?n:ut(n,t)},vt=ze("unscopables"),mt=Array.prototype;null==mt[vt]&&C.f(mt,vt,{configurable:!0,value:gt(null)});var yt=function(e){mt[vt][e]=!0},bt=it.find,wt=!0;"find"in[]&&Array(1).find(function(){wt=!1}),Re({target:"Array",proto:!0,forced:wt},{find:function(e){return bt(this,e,arguments.length>1?arguments[1]:void 0)}}),yt("find");var St=ge.includes;Re({target:"Array",proto:!0},{includes:function(e){return St(this,e,arguments.length>1?arguments[1]:void 0)}}),yt("includes");var It=function(e){return function(t,n,r,i){et(n);var o=b(t),a=p(o),s=le(o.length),c=e?s-1:0,u=e?-1:1;if(r<2)for(;;){if(c in a){i=a[c],c+=u;break}if(c+=u,e?c<0:s<=c)throw TypeError("Reduce of empty array with no initial value")}for(;e?c>=0:s>c;c+=u)c in a&&(i=n(i,a[c],c,o));return i}},Et={left:It(!1),right:It(!0)},Tt=function(e,t){var n=[][e];return!!n&&o(function(){n.call(null,t||function(){throw 1},1)})},Pt="process"==f(i.process),_t=Et.left,kt=Tt("reduce");Re({target:"Array",proto:!0,forced:!kt||!Pt&&je>79&&je<83},{reduce:function(e){return _t(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}});var At=Qe("slice"),Ot=ze("species"),Ct=[].slice,xt=Math.max;Re({target:"Array",proto:!0,forced:!At},{slice:function(e,t){var n,r,i,o=v(this),a=le(o.length),s=he(e,a),c=he(void 0===t?a:t,a);if(De(o)&&("function"!=typeof(n=o.constructor)||n!==Array&&!De(n.prototype)?m(n)&&null===(n=n[Ot])&&(n=void 0):n=void 0,n===Array||void 0===n))return Ct.call(o,s,c);for(r=new(void 0===n?Array:n)(xt(c-s,0)),i=0;s<c;s++,i++)s in o&&Me(r,i,o[s]);return r.length=i,r}});var Rt=Object.assign,Dt=Object.defineProperty,Mt=!Rt||o(function(){if(a&&1!==Rt({b:1},Rt(Dt({},"a",{enumerable:!0,get:function(){Dt(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol();return e[n]=7,"abcdefghijklmnopqrst".split("").forEach(function(e){t[e]=e}),7!=Rt({},e)[n]||"abcdefghijklmnopqrst"!=ct(Rt({},t)).join("")})?function(e,t){for(var n=b(e),r=arguments.length,i=1,o=Se.f,s=u.f;r>i;)for(var c,l=p(arguments[i++]),d=o?ct(l).concat(o(l)):ct(l),f=d.length,h=0;f>h;)c=d[h++],a&&!s.call(l,c)||(n[c]=l[c]);return n}:Rt;Re({target:"Object",stat:!0,forced:Object.assign!==Mt},{assign:Mt});var Nt=i.Promise,Ut=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return A(n),function(e){if(!m(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype")}(r),t?e.call(n,r):n.__proto__=r,n}}():void 0),Ft=C.f,Lt=ze("toStringTag"),jt=function(e,t,n){e&&!S(e=n?e:e.prototype,Lt)&&Ft(e,Lt,{configurable:!0,value:t})},Bt=ze("species"),Wt=function(e){var t=oe(e);a&&t&&!t[Bt]&&(0,C.f)(t,Bt,{configurable:!0,get:function(){return this}})},qt={},Vt=ze("iterator"),Jt=Array.prototype,zt={};zt[ze("toStringTag")]="z";var Ht="[object z]"===String(zt),Kt=ze("toStringTag"),Gt="Arguments"==f(function(){return arguments}()),Qt=Ht?f:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),Kt))?n:Gt?f(t):"Object"==(r=f(t))&&"function"==typeof t.callee?"Arguments":r},$t=ze("iterator"),Yt=function(e){var t=e.return;if(void 0!==t)return A(t.call(e)).value},Xt=function(e,t){this.stopped=e,this.result=t},Zt=function(e,t,n){var r,i,o,a,s,c,u,l,d=!(!n||!n.AS_ENTRIES),f=!(!n||!n.IS_ITERATOR),h=!(!n||!n.INTERRUPTED),p=tt(t,n&&n.that,1+d+h),g=function(e){return r&&Yt(r),new Xt(!0,e)},v=function(e){return d?(A(e),h?p(e[0],e[1],g):p(e[0],e[1])):h?p(e,g):p(e)};if(f)r=e;else{if("function"!=typeof(i=function(e){if(null!=e)return e[$t]||e["@@iterator"]||qt[Qt(e)]}(e)))throw TypeError("Target is not iterable");if(void 0!==(l=i)&&(qt.Array===l||Jt[Vt]===l)){for(o=0,a=le(e.length);a>o;o++)if((s=v(e[o]))&&s instanceof Xt)return s;return new Xt(!1)}r=i.call(e)}for(c=r.next;!(u=c.call(r)).done;){try{s=v(u.value)}catch(e){throw Yt(r),e}if("object"==typeof s&&s&&s instanceof Xt)return s}return new Xt(!1)},en=ze("iterator"),tn=!1;try{var nn=0,rn={next:function(){return{done:!!nn++}},return:function(){tn=!0}};rn[en]=function(){return this},Array.from(rn,function(){throw 2})}catch(ls){}var on,an,sn,cn=ze("species"),un=/(?:iphone|ipod|ipad).*applewebkit/i.test(Ne),ln=i.location,dn=i.setImmediate,fn=i.clearImmediate,hn=i.process,pn=i.MessageChannel,gn=i.Dispatch,vn=0,mn={},yn=function(e){if(mn.hasOwnProperty(e)){var t=mn[e];delete mn[e],t()}},bn=function(e){return function(){yn(e)}},wn=function(e){yn(e.data)},Sn=function(e){i.postMessage(e+"",ln.protocol+"//"+ln.host)};dn&&fn||(dn=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return mn[++vn]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},on(vn),vn},fn=function(e){delete mn[e]},Pt?on=function(e){hn.nextTick(bn(e))}:gn&&gn.now?on=function(e){gn.now(bn(e))}:pn&&!un?(sn=(an=new pn).port2,an.port1.onmessage=wn,on=tt(sn.postMessage,sn,1)):i.addEventListener&&"function"==typeof postMessage&&!i.importScripts&&ln&&"file:"!==ln.protocol&&!o(Sn)?(on=Sn,i.addEventListener("message",wn,!1)):on="onreadystatechange"in T("script")?function(e){lt.appendChild(T("script")).onreadystatechange=function(){lt.removeChild(this),yn(e)}}:function(e){setTimeout(bn(e),0)});var In,En,Tn,Pn,_n,kn,An,On,Cn={set:dn,clear:fn},xn=/web0s(?!.*chrome)/i.test(Ne),Rn=Cn.set,Dn=i.MutationObserver||i.WebKitMutationObserver,Mn=i.document,Nn=i.process,Un=i.Promise,Fn=(0,k.f)(i,"queueMicrotask"),Ln=Fn&&Fn.value;Ln||(In=function(){var e,t;for(Pt&&(e=Nn.domain)&&e.exit();En;){t=En.fn,En=En.next;try{t()}catch(e){throw En?Pn():Tn=void 0,e}}Tn=void 0,e&&e.enter()},un||Pt||xn||!Dn||!Mn?Un&&Un.resolve?((An=Un.resolve(void 0)).constructor=Un,On=An.then,Pn=function(){On.call(An,In)}):Pn=Pt?function(){Nn.nextTick(In)}:function(){Rn.call(i,In)}:(_n=!0,kn=Mn.createTextNode(""),new Dn(In).observe(kn,{characterData:!0}),Pn=function(){kn.data=_n=!_n}));var jn,Bn,Wn,qn,Vn=Ln||function(e){var t={fn:e,next:void 0};Tn&&(Tn.next=t),En||(En=t,Pn()),Tn=t},Jn=function(e){var t,n;this.promise=new e(function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r}),this.resolve=et(t),this.reject=et(n)},zn={f:function(e){return new Jn(e)}},Hn=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},Kn="object"==typeof window,Gn=Cn.set,Qn=ze("species"),$n=te.get,Yn=te.set,Xn=te.getterFor("Promise"),Zn=Nt&&Nt.prototype,er=Nt,tr=Zn,nr=i.TypeError,rr=i.document,ir=i.process,or=zn.f,ar=or,sr=!!(rr&&rr.createEvent&&i.dispatchEvent),cr="function"==typeof PromiseRejectionEvent,ur=!1,lr=Ce("Promise",function(){var e=L(er)!==String(er);if(!e&&66===je)return!0;if(je>=51&&/native code/.test(er))return!1;var t=new er(function(e){e(1)}),n=function(e){e(function(){},function(){})};return(t.constructor={})[Qn]=n,!(ur=t.then(function(){})instanceof n)||!e&&Kn&&!cr}),dr=lr||!function(e,t){if(!tn)return!1;var n=!1;try{var r={};r[en]=function(){return{next:function(){return{done:n=!0}}}},er.all(r).catch(function(){})}catch(e){}return n}(),fr=function(e){var t;return!(!m(e)||"function"!=typeof(t=e.then))&&t},hr=function(e,t){if(!e.notified){e.notified=!0;var n=e.reactions;Vn(function(){for(var r=e.value,i=1==e.state,o=0;n.length>o;){var a,s,c,u=n[o++],l=i?u.ok:u.fail,d=u.resolve,f=u.reject,h=u.domain;try{l?(i||(2===e.rejection&&mr(e),e.rejection=1),!0===l?a=r:(h&&h.enter(),a=l(r),h&&(h.exit(),c=!0)),a===u.promise?f(nr("Promise-chain cycle")):(s=fr(a))?s.call(a,d,f):d(a)):f(r)}catch(e){h&&!c&&h.exit(),f(e)}}e.reactions=[],e.notified=!1,t&&!e.rejection&&gr(e)})}},pr=function(e,t,n){var r,o;sr?((r=rr.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),i.dispatchEvent(r)):r={promise:t,reason:n},!cr&&(o=i["on"+e])?o(r):"unhandledrejection"===e&&function(e,t){var n=i.console;n&&n.error&&(1===arguments.length?n.error(e):n.error(e,t))}("Unhandled promise rejection",n)},gr=function(e){Gn.call(i,function(){var t,n=e.facade,r=e.value;if(vr(e)&&(t=Hn(function(){Pt?ir.emit("unhandledRejection",r,n):pr("unhandledrejection",n,r)}),e.rejection=Pt||vr(e)?2:1,t.error))throw t.value})},vr=function(e){return 1!==e.rejection&&!e.parent},mr=function(e){Gn.call(i,function(){var t=e.facade;Pt?ir.emit("rejectionHandled",t):pr("rejectionhandled",t,e.value)})},yr=function(e,t,n){return function(r){e(t,r,n)}},br=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,hr(e,!0))},wr=function e(t,n,r){if(!t.done){t.done=!0,r&&(t=r);try{if(t.facade===n)throw nr("Promise can't be resolved itself");var i=fr(n);i?Vn(function(){var r={done:!1};try{i.call(n,yr(e,r,t),yr(br,r,t))}catch(e){br(r,e,t)}}):(t.value=n,t.state=1,hr(t,!1))}catch(e){br({done:!1},e,t)}}};if(lr&&(er=function(e){!function(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect Promise invocation")}(this,er),et(e),jn.call(this);var t=$n(this);try{e(yr(wr,t),yr(br,t))}catch(e){br(t,e)}},(jn=function(e){Yn(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=function(e,t,n){for(var r in t)ne(e,r,t[r],void 0);return e}(tr=er.prototype,{then:function(e,t){var n,r,i,o=Xn(this),a=or((n=er,void 0===(i=A(this).constructor)||null==(r=A(i)[cn])?n:et(r)));return a.ok="function"!=typeof e||e,a.fail="function"==typeof t&&t,a.domain=Pt?ir.domain:void 0,o.parent=!0,o.reactions.push(a),0!=o.state&&hr(o,!1),a.promise},catch:function(e){return this.then(void 0,e)}}),Bn=function(){var e=new jn,t=$n(e);this.promise=e,this.resolve=yr(wr,t),this.reject=yr(br,t)},zn.f=or=function(e){return e===er||e===Wn?new Bn(e):ar(e)},"function"==typeof Nt&&Zn!==Object.prototype)){qn=Zn.then,ur||(ne(Zn,"then",function(e,t){var n=this;return new er(function(e,t){qn.call(n,e,t)}).then(e,t)},{unsafe:!0}),ne(Zn,"catch",tr.catch,{unsafe:!0}));try{delete Zn.constructor}catch(ls){}Ut&&Ut(Zn,tr)}Re({global:!0,wrap:!0,forced:lr},{Promise:er}),jt(er,"Promise",!1),Wt("Promise"),Wn=oe("Promise"),Re({target:"Promise",stat:!0,forced:lr},{reject:function(e){var t=or(this);return t.reject.call(void 0,e),t.promise}}),Re({target:"Promise",stat:!0,forced:lr},{resolve:function(e){return function(e,t){if(A(e),m(t)&&t.constructor===e)return t;var n=zn.f(e);return(0,n.resolve)(t),n.promise}(this,e)}}),Re({target:"Promise",stat:!0,forced:dr},{all:function(e){var t=this,n=or(t),r=n.resolve,i=n.reject,o=Hn(function(){var n=et(t.resolve),o=[],a=0,s=1;Zt(e,function(e){var c=a++,u=!1;o.push(void 0),s++,n.call(t,e).then(function(e){u||(u=!0,o[c]=e,--s||r(o))},i)}),--s||r(o)});return o.error&&i(o.value),n.promise},race:function(e){var t=this,n=or(t),r=n.reject,i=Hn(function(){var i=et(t.resolve);Zt(e,function(e){i.call(t,e).then(n.resolve,r)})});return i.error&&r(i.value),n.promise}});var Sr=function(){var e=A(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t};function Ir(e,t){return RegExp(e,t)}var Er={UNSUPPORTED_Y:o(function(){var e=Ir("a","y");return e.lastIndex=2,null!=e.exec("abcd")}),BROKEN_CARET:o(function(){var e=Ir("^r","gy");return e.lastIndex=2,null!=e.exec("str")})};a&&("g"!=/./g.flags||Er.UNSUPPORTED_Y)&&C.f(RegExp.prototype,"flags",{configurable:!0,get:Sr});var Tr=ze("match"),Pr=function(e){var t;return m(e)&&(void 0!==(t=e[Tr])?!!t:"RegExp"==f(e))},_r=function(e){if(Pr(e))throw TypeError("The method doesn't accept regular expressions");return e},kr=ze("match");Re({target:"String",proto:!0,forced:!function(e){var t=/./;try{"/./".includes(t)}catch(e){try{return t[kr]=!1,"/./".includes(t)}catch(e){}}return!1}()},{includes:function(e){return!!~String(g(this)).indexOf(_r(e),arguments.length>1?arguments[1]:void 0)}});var Ar=RegExp.prototype.exec,Or=W("native-string-replace",String.prototype.replace),Cr=Ar,xr=function(){var e=/a/,t=/b*/g;return Ar.call(e,"a"),Ar.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),Rr=Er.UNSUPPORTED_Y||Er.BROKEN_CARET,Dr=void 0!==/()??/.exec("")[1];(xr||Dr||Rr)&&(Cr=function(e){var t,n,r,i,o=this,a=Rr&&o.sticky,s=Sr.call(o),c=o.source,u=0,l=e;return a&&(-1===(s=s.replace("y","")).indexOf("g")&&(s+="g"),l=String(e).slice(o.lastIndex),o.lastIndex>0&&(!o.multiline||o.multiline&&"\n"!==e[o.lastIndex-1])&&(c="(?: "+c+")",l=" "+l,u++),n=new RegExp("^(?:"+c+")",s)),Dr&&(n=new RegExp("^"+c+"$(?!\\s)",s)),xr&&(t=o.lastIndex),r=Ar.call(a?n:o,l),a?r?(r.input=r.input.slice(u),r[0]=r[0].slice(u),r.index=o.lastIndex,o.lastIndex+=r[0].length):o.lastIndex=0:xr&&r&&(o.lastIndex=o.global?r.index+r[0].length:t),Dr&&r&&r.length>1&&Or.call(r[0],n,function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)}),r});var Mr=Cr;Re({target:"RegExp",proto:!0,forced:/./.exec!==Mr},{exec:Mr}),ze("species");var Nr=RegExp.prototype,Ur=(o(function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}),"a".replace(/./,"$0"),ze("replace")),Fr=(!!/./[Ur]&&/./[Ur]("a","$0"),o(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}),Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t});!function(e,t,n,r){var i,a,s,c=ze(e),u=!o(function(){var t={};return t[c]=function(){return 7},7!=""[e](t)}),l=u&&!o(function(){var e=!1,t=/a/;return t.exec=function(){return e=!0,null},t[c](""),!e});if(!u||!l){var d=/./[c],h=(i=c,a=""[e],s=function(e,t,n,r,i){var o=t.exec;return o===Mr||o===Nr.exec?u&&!i?{done:!0,value:d.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}},[function(e){var t=g(this),n=null==e?void 0:e[i];return void 0!==n?n.call(e,t):new RegExp(e)[i](String(t))},function(e){var t=s(a,e,this);if(t.done)return t.value;var n=A(e),r=String(this),i=n.lastIndex;Fr(i,0)||(n.lastIndex=0);var o=function(e,t){var n=e.exec;if("function"==typeof n){var r=n.call(e,t);if("object"!=typeof r)throw TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==f(e))throw TypeError("RegExp#exec called on incompatible receiver");return Mr.call(e,t)}(n,r);return Fr(n.lastIndex,i)||(n.lastIndex=i),null===o?-1:o.index}]),p=h[1];ne(String.prototype,e,h[0]),ne(Nr,c,function(e){return p.call(e,this)})}}("search");var Lr="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),jr=new Uint8Array(16);function Br(){if(!Lr)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Lr(jr)}var Wr=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function qr(e){return"string"==typeof e&&Wr.test(e)}for(var Vr=[],Jr=0;Jr<256;++Jr)Vr.push((Jr+256).toString(16).substr(1));function zr(e,t,n){var r=(e=e||{}).random||(e.rng||Br)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=r[i];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(Vr[e[t+0]]+Vr[e[t+1]]+Vr[e[t+2]]+Vr[e[t+3]]+"-"+Vr[e[t+4]]+Vr[e[t+5]]+"-"+Vr[e[t+6]]+Vr[e[t+7]]+"-"+Vr[e[t+8]]+Vr[e[t+9]]+"-"+Vr[e[t+10]]+Vr[e[t+11]]+Vr[e[t+12]]+Vr[e[t+13]]+Vr[e[t+14]]+Vr[e[t+15]]).toLowerCase();if(!qr(n))throw TypeError("Stringified UUID is invalid");return n}(r)}function Hr(){return(Hr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Kr(e){return(Kr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gr(e,t){return(Gr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Qr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function $r(e,t,n){return($r=Qr()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&Gr(i,n.prototype),i}).apply(null,arguments)}function Yr(e){var t="function"==typeof Map?new Map:void 0;return(Yr=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return $r(e,arguments,Kr(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Gr(n,e)})(e)}function Xr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Zr=n(function(e,t){function n(e){switch(e){case"http:":return 80;case"https:":return 443;default:return location.port}}t.parse=function(e){var t=document.createElement("a");return t.href=e,{href:t.href,host:t.host||location.host,port:"0"===t.port||""===t.port?n(t.protocol):t.port,hash:t.hash,hostname:t.hostname||location.hostname,pathname:"/"!=t.pathname.charAt(0)?"/"+t.pathname:t.pathname,protocol:t.protocol&&":"!=t.protocol?t.protocol:location.protocol,search:t.search,query:t.search.slice(1)}},t.isAbsolute=function(e){return 0==e.indexOf("//")||!!~e.indexOf("://")},t.isRelative=function(e){return!t.isAbsolute(e)},t.isCrossDomain=function(e){e=t.parse(e);var n=t.parse(window.location.href);return e.hostname!==n.hostname||e.port!==n.port||e.protocol!==n.protocol}}),ei=1e3,ti=6e4,ni=60*ti,ri=24*ni,ii=function(e,t){return t=t||{},"string"==typeof e?function(e){if(!((e=""+e).length>1e4)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*n;case"days":case"day":case"d":return n*ri;case"hours":case"hour":case"hrs":case"hr":case"h":return n*ni;case"minutes":case"minute":case"mins":case"min":case"m":return n*ti;case"seconds":case"second":case"secs":case"sec":case"s":return n*ei;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}}}(e):t.long?function(e){return oi(e,ri,"day")||oi(e,ni,"hour")||oi(e,ti,"minute")||oi(e,ei,"second")||e+" ms"}(e):function(e){return e>=ri?Math.round(e/ri)+"d":e>=ni?Math.round(e/ni)+"h":e>=ti?Math.round(e/ti)+"m":e>=ei?Math.round(e/ei)+"s":e+"ms"}(e)};function oi(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var ai=n(function(e,t){(t=e.exports=function(e){function r(){}function o(){var e=o,r=+new Date,a=r-(n||r);e.diff=a,e.prev=n,e.curr=r,n=r,null==e.useColors&&(e.useColors=t.useColors()),null==e.color&&e.useColors&&(e.color=i());var s=Array.prototype.slice.call(arguments);s[0]=t.coerce(s[0]),"string"!=typeof s[0]&&(s=["%o"].concat(s));var c=0;s[0]=s[0].replace(/%([a-z%])/g,function(n,r){if("%%"===n)return n;c++;var i=t.formatters[r];return"function"==typeof i&&(n=i.call(e,s[c]),s.splice(c,1),c--),n}),"function"==typeof t.formatArgs&&(s=t.formatArgs.apply(e,s));var u=o.log||t.log||console.log.bind(console);u.apply(e,s)}r.enabled=!1,o.enabled=!0;var a=t.enabled(e)?o:r;return a.namespace=e,a}).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e);for(var n=(e||"").split(/[\s,]+/),r=n.length,i=0;i<r;i++)n[i]&&("-"===(e=n[i].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=ii,t.names=[],t.skips=[],t.formatters={};var n,r=0;function i(){return t.colors[r++%t.colors.length]}}),si=n(function(e,t){function n(){var e;try{e=t.storage.debug}catch(e){}return e}(t=e.exports=ai).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(){var e=arguments,n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return e;var r="color: "+this.color;e=[e[0],r,"color: inherit"].concat(Array.prototype.slice.call(e,1));var i=0,o=0;return e[0].replace(/%[a-z%]/g,function(e){"%%"!==e&&(i++,"%c"===e&&(o=i))}),e.splice(o,0,r),e},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=n,t.useColors=function(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){return JSON.stringify(e)},t.enable(n())})("cookie"),ci=function(e,t,n){switch(arguments.length){case 3:case 2:return ui(e,t,n);case 1:return di(e);default:return li()}};function ui(e,t,n){n=n||{};var r=fi(e)+"="+fi(t);null==t&&(n.maxage=-1),n.maxage&&(n.expires=new Date(+new Date+n.maxage)),n.path&&(r+="; path="+n.path),n.domain&&(r+="; domain="+n.domain),n.expires&&(r+="; expires="+n.expires.toUTCString()),n.secure&&(r+="; secure"),document.cookie=r}function li(){var e;try{e=document.cookie}catch(e){return"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e.stack||e),{}}return function(e){var t,n={},r=e.split(/ *; */);if(""==r[0])return n;for(var i=0;i<r.length;++i)n[hi((t=r[i].split("="))[0])]=hi(t[1]);return n}(e)}function di(e){return li()[e]}function fi(e){try{return encodeURIComponent(e)}catch(t){si("error `encode(%o)` - %o",e,t)}}function hi(e){try{return decodeURIComponent(e)}catch(t){si("error `decode(%o)` - %o",e,t)}}var pi=n(function(e,t){var n=Zr.parse;function r(e){for(var n=t.cookie,r=t.levels(e),i=0;i<r.length;++i){var o=r[i],a={domain:"."+o};if(n("__tld__",1,a),n("__tld__"))return n("__tld__",null,a),o}return""}r.levels=function(e){var t=n(e).hostname.split("."),r=t[t.length-1],i=[];if(4===t.length&&r===parseInt(r,10))return i;if(t.length<=1)return i;for(var o=t.length-2;o>=0;--o)i.push(t.slice(o).join("."));return i},r.cookie=ci,t=e.exports=r}),gi=function(){var e;-1!==window.location.search.search(/[?&]wmpsm_debug=[1t]/)&&(e=console).info.apply(e,[].slice.call(arguments))};function vi(e,t,n){switch(arguments.length){case 3:case 2:return mi(e,t,n);case 1:return bi(e);default:return yi()}}function mi(e,t,n){n=n||{};var r=wi(e)+"="+wi(t);!1===n.encode&&(r=e+"="+t),null==t&&(n.maxage=-1),n.maxage&&!n.expires&&(n.expires=new Date(+new Date+n.maxage)),n.path&&(r+="; Path="+n.path),n.domain&&(r+="; Domain="+n.domain),n.expires&&(r+="; Expires="+n.expires.toUTCString()),n.samesite&&(r+="; SameSite="+n.samesite),n.secure&&(r+="; Secure"),gi("[COOKIE]: cookie.helper.set()",r,n),document.cookie=r}function yi(){var e;try{e=document.cookie}catch(e){return"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e.stack||e),{}}return function(e){var t={},n=e.split(/ *; */);if(""==n[0])return t;for(var r=0;r<n.length;++r){var i=n[r].substr(0,n[r].indexOf("=")),o=n[r].substr(n[r].indexOf("=")+1);t[Si(i)]=Si(o)}return t}(e)}function bi(e){var t=yi()[e];return gi("[COOKIE]: helper.get() - getting "+e+" cookie value "+t),t}function wi(e){try{return encodeURIComponent(e)}catch(e){}}function Si(e){try{return decodeURIComponent(e)}catch(e){}}var Ii=new(function(){function e(e){this._options={},this.options=this.options.bind(this),this.set=this.set.bind(this),this.get=this.get.bind(this),this.getAll=this.getAll.bind(this),this.remove=this.remove.bind(this),this.options(e)}var t=e.prototype;return t.options=function(e){if(0===arguments.length)return this._options;var t=(e=e||{}).domain||"."+pi(window.location.href);if("."===t&&(t=null),this._options=Hr({maxage:31536e6,path:"/",samesite:"Lax",encode:!0},e,{domain:t}),this.set("psm:test",!0,this._options),!this.get("psm:test")){gi("[Cookie]: psm:test cookie could not be set at domain: ",this._options.domain);var n=new RegExp(document.location.hostname,"g");""!==document.referrer&&-1===document.referrer.search(n)?this._options.samesite="None":this._options.domain=null}this.remove("psm:test"),gi("[COOKIE]: this._options",this._options)},t.set=function(e,t,n){void 0===n&&(n={});var r=Hr({},this._options,n);gi("[COOKIE]: this.set() options",r);try{return"string"!=typeof t&&(t=JSON.stringify(t)),vi(e,"null"===t?null:t,r),!0}catch(e){return gi("[COOKIE]: this.set() encountered an error",e),!1}},t.get=function(e){var t=vi(e);try{return JSON.parse(t)}catch(e){return t||null}},t.getAll=function(){return vi()},t.remove=function(e){try{return vi(e,null,Hr({},this._options)),!0}catch(e){return gi("[COOKIE]: this.remove() encountered an error",e),!1}},e}()),Ei="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),Ti=new Uint8Array(16);function Pi(){if(!Ei)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ei(Ti)}var _i=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function ki(e){return"string"==typeof e&&_i.test(e)}for(var Ai=[],Oi=0;Oi<256;++Oi)Ai.push((Oi+256).toString(16).substr(1));function Ci(e,t,n){var r=(e=e||{}).random||(e.rng||Pi)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=r[i];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(Ai[e[t+0]]+Ai[e[t+1]]+Ai[e[t+2]]+Ai[e[t+3]]+"-"+Ai[e[t+4]]+Ai[e[t+5]]+"-"+Ai[e[t+6]]+Ai[e[t+7]]+"-"+Ai[e[t+8]]+Ai[e[t+9]]+"-"+Ai[e[t+10]]+Ai[e[t+11]]+Ai[e[t+12]]+Ai[e[t+13]]+Ai[e[t+14]]+Ai[e[t+15]]).toLowerCase();if(!ki(n))throw TypeError("Stringified UUID is invalid");return n}(r)}function xi(e){return"string"==typeof e.payload?e.payload:e.payload instanceof String?e.payload.valueOf():JSON.stringify(e.payload)}var Ri,Di,Mi,Ni="Cache was used due to remote loading failing.",Ui=function(){function e(e,t){switch(this.storageType=void 0,this.clientId=void 0,this.storage=void 0,this.warnings=void 0,this.storageType=e,this.clientId=t,this.warnings=[],this.clientId||this.warnings.push({code:"MULTIPLE_INSTANCES_SUPPORT",message:"A clientId must be provided for multiple instance support."}),this.storageType){case"localStorage":try{this.storage=localStorage}catch(e){this.warnings.push({code:"UNABLE_TO_ACCESS_LOCAL_STORAGE",message:"Unable to access localStorage: "+e})}break;case"sessionStorage":try{this.storage=sessionStorage}catch(e){this.warnings.push({code:"UNABLE_TO_ACCESS_SESSION_STORAGE",message:"Unable to access sessionStorage: "+e})}break;case"inMemory":default:try{this.storage=localStorage;break}catch(e){this.warnings.push({code:"UNABLE_TO_ACCESS_LOCAL_STORAGE",message:"Unable to access localStorage: "+e})}}}var t=e.prototype;return t.get=function(e){var t;if("undefined"!=typeof Storage){var n=e;this.clientId&&(n=n+"-"+this.clientId);try{t=this.storage.getItem(n)}catch(e){this.warnings.push({code:"UNABLE_TO_ACCESS_LOCAL_STORAGE",message:"Unable to access localStorage: "+e})}return t}},t.set=function(e,t){if("undefined"!=typeof Storage){var n=e;this.clientId&&(n=n+"-"+this.clientId);try{this.storage.setItem(n,t)}catch(e){this.warnings.push({code:"UNABLE_TO_ACCESS_LOCAL_STORAGE",message:"Unable to access localStorage: "+e})}}},t.delete=function(e){if("undefined"!=typeof Storage){var t=e;this.clientId&&(t=t+"-"+this.clientId);try{this.storage.deleteItem(t)}catch(e){this.warnings.push({code:"UNABLE_TO_ACCESS_LOCAL_STORAGE",message:"Unable to access localStorage: "+e})}}},e}(),Fi=!o(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),Li=H("IE_PROTO"),ji=Object.prototype,Bi=Fi?Object.getPrototypeOf:function(e){return e=b(e),S(e,Li)?e[Li]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?ji:null},Wi=ze("iterator"),qi=!1;[].keys&&("next"in(Mi=[].keys())?(Di=Bi(Bi(Mi)))!==Object.prototype&&(Ri=Di):qi=!0),(null==Ri||o(function(){var e={};return Ri[Wi].call(e)!==e}))&&(Ri={}),S(Ri,Wi)||x(Ri,Wi,function(){return this});var Vi={IteratorPrototype:Ri,BUGGY_SAFARI_ITERATORS:qi},Ji=Vi.IteratorPrototype,zi=function(){return this},Hi=Vi.IteratorPrototype,Ki=Vi.BUGGY_SAFARI_ITERATORS,Gi=ze("iterator"),Qi=function(){return this},$i=te.set,Yi=te.getterFor("Array Iterator");function Xi(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}!function(e,t,n,r,i,o,a){!function(e,t,n){e.prototype=gt(Ji,{next:l(1,function(){var e=Yi(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}})}),jt(e,"Array Iterator",!1),qt["Array Iterator"]=zi}(n);var s,c,u,d=function(e){if("values"===e&&g)return g;if(!Ki&&e in h)return h[e];switch(e){case"keys":case"values":case"entries":return function(){return new n(this,e)}}return function(){return new n(this)}},f=!1,h=e.prototype,p=h[Gi]||h["@@iterator"]||h.values,g=!Ki&&p||d("values"),v=h.entries||p;if(v&&(s=Bi(v.call(new e)),Hi!==Object.prototype&&s.next&&(Bi(s)!==Hi&&(Ut?Ut(s,Hi):"function"!=typeof s[Gi]&&x(s,Gi,Qi)),jt(s,"Array Iterator",!0))),p&&"values"!==p.name&&(f=!0,g=function(){return p.call(this)}),h[Gi]!==g&&x(h,Gi,g),qt.Array=g,void(c={values:d("values"),keys:d("keys"),entries:d("entries")}))for(u in c)(Ki||f||!(u in h))&&ne(h,u,c[u]);else Re({target:"Array",proto:!0,forced:Ki||f},c)}(Array,0,function(e,t){$i(this,{type:"Array Iterator",target:v(e),index:0,kind:t})}),qt.Arguments=qt.Array,yt("keys"),yt("values"),yt("entries");var Zi="input is invalid type",eo="0123456789abcdef".split(""),to=[-2147483648,8388608,32768,128],no=[24,16,8,0],ro=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],io=function(){function e(){this.blocks=[],this.h0=void 0,this.h1=void 0,this.h2=void 0,this.h3=void 0,this.h4=void 0,this.h5=void 0,this.h6=void 0,this.h7=void 0,this.block=void 0,this.start=void 0,this.bytes=void 0,this.hBytes=void 0,this.finalized=void 0,this.hashed=void 0,this.first=void 0,this.lastByteIndex=void 0,this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}var t=e.prototype;return t.create=function(){return this},t.update=function(e){if(!this.finalized){var t,n=typeof e;if("string"!==n){if("object"!==n)throw new Error(Zi);if(null===e)throw new Error(Zi);if(e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!Array.isArray(e)&&!ArrayBuffer.isView(e))throw new Error(Zi);t=!0}for(var r,i,o=0,a=e.length,s=this.blocks;o<a;){if(this.hashed&&(this.hashed=!1,s[0]=this.block,s[16]=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=0),t)for(i=this.start;o<a&&i<64;++o)s[i>>2]|=e[o]<<no[3&i++];else for(i=this.start;o<a&&i<64;++o)(r=e.charCodeAt(o))<128?s[i>>2]|=r<<no[3&i++]:r<2048?(s[i>>2]|=(192|r>>6)<<no[3&i++],s[i>>2]|=(128|63&r)<<no[3&i++]):r<55296||r>=57344?(s[i>>2]|=(224|r>>12)<<no[3&i++],s[i>>2]|=(128|r>>6&63)<<no[3&i++],s[i>>2]|=(128|63&r)<<no[3&i++]):(r=65536+((1023&r)<<10|1023&e.charCodeAt(++o)),s[i>>2]|=(240|r>>18)<<no[3&i++],s[i>>2]|=(128|r>>12&63)<<no[3&i++],s[i>>2]|=(128|r>>6&63)<<no[3&i++],s[i>>2]|=(128|63&r)<<no[3&i++]);this.lastByteIndex=i,this.bytes+=i-this.start,i>=64?(this.block=s[16],this.start=i-64,this.hash(),this.hashed=!0):this.start=i}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},t.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>2]|=to[3&t],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},t.hash=function(){var e,t,n,r,i,o,a=this.h0,s=this.h1,c=this.h2,u=this.h3,l=this.h4,d=this.h5,f=this.h6,h=this.h7,p=this.blocks;for(e=16;e<64;++e)p[e]=p[e-16]+(((t=p[e-15])>>>7|t<<25)^(t>>>18|t<<14)^t>>>3)+p[e-7]+(((t=p[e-2])>>>17|t<<15)^(t>>>19|t<<13)^t>>>10)<<0;for(o=s&c,e=0;e<64;e+=4)this.first?(n=704751109,h=(t=p[0]-210244248)-1521486534<<0,u=t+143694565<<0,this.first=!1):(h=u+(t=h+((l>>>6|l<<26)^(l>>>11|l<<21)^(l>>>25|l<<7))+(l&d^~l&f)+ro[e]+p[e])<<0,u=t+(((a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10))+((n=a&s)^a&c^o))<<0),f=c+(t=f+((h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7))+(h&l^~h&d)+ro[e+1]+p[e+1])<<0,c=t+(((u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10))+((r=u&a)^u&s^n))<<0,d=s+(t=d+((f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+(f&h^~f&l)+ro[e+2]+p[e+2])<<0,s=t+(((c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10))+((i=c&u)^c&a^r))<<0,l=a+(t=l+((d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7))+(d&f^~d&h)+ro[e+3]+p[e+3])<<0,a=t+(((s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10))+((o=s&c)^s&u^i))<<0;this.h0=this.h0+a<<0,this.h1=this.h1+s<<0,this.h2=this.h2+c<<0,this.h3=this.h3+u<<0,this.h4=this.h4+l<<0,this.h5=this.h5+d<<0,this.h6=this.h6+f<<0,this.h7=this.h7+h<<0},t.hex=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3,i=this.h4,o=this.h5,a=this.h6,s=this.h7;return eo[e>>28&15]+eo[e>>24&15]+eo[e>>20&15]+eo[e>>16&15]+eo[e>>12&15]+eo[e>>8&15]+eo[e>>4&15]+eo[15&e]+eo[t>>28&15]+eo[t>>24&15]+eo[t>>20&15]+eo[t>>16&15]+eo[t>>12&15]+eo[t>>8&15]+eo[t>>4&15]+eo[15&t]+eo[n>>28&15]+eo[n>>24&15]+eo[n>>20&15]+eo[n>>16&15]+eo[n>>12&15]+eo[n>>8&15]+eo[n>>4&15]+eo[15&n]+eo[r>>28&15]+eo[r>>24&15]+eo[r>>20&15]+eo[r>>16&15]+eo[r>>12&15]+eo[r>>8&15]+eo[r>>4&15]+eo[15&r]+eo[i>>28&15]+eo[i>>24&15]+eo[i>>20&15]+eo[i>>16&15]+eo[i>>12&15]+eo[i>>8&15]+eo[i>>4&15]+eo[15&i]+eo[o>>28&15]+eo[o>>24&15]+eo[o>>20&15]+eo[o>>16&15]+eo[o>>12&15]+eo[o>>8&15]+eo[o>>4&15]+eo[15&o]+eo[a>>28&15]+eo[a>>24&15]+eo[a>>20&15]+eo[a>>16&15]+eo[a>>12&15]+eo[a>>8&15]+eo[a>>4&15]+eo[15&a]+(eo[s>>28&15]+eo[s>>24&15]+eo[s>>20&15]+eo[s>>16&15]+eo[s>>12&15]+eo[s>>8&15]+eo[s>>4&15]+eo[15&s])},t.toString=function(){return this.hex()},t.digest=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3,i=this.h4,o=this.h5,a=this.h6,s=this.h7,c=[e>>24&255,e>>16&255,e>>8&255,255&e,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24&255,n>>16&255,n>>8&255,255&n,r>>24&255,r>>16&255,r>>8&255,255&r,i>>24&255,i>>16&255,i>>8&255,255&i,o>>24&255,o>>16&255,o>>8&255,255&o,a>>24&255,a>>16&255,a>>8&255,255&a];return c.push(s>>24&255,s>>16&255,s>>8&255,255&s),c},t.array=function(){return this.digest()},t.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(32),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),t.setUint32(20,this.h5),t.setUint32(24,this.h6),t.setUint32(28,this.h7),e},e}();Object.entries||(Object.entries=function(e){for(var t=Object.keys(e),n=t.length,r=new Array(n);n--;)r[n]=[t[n],e[t[n]]];return r}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw TypeError("predicate must be a function");for(var r=arguments[1],i=0;i<n;){var o=t[i];if(e.call(r,o,i,t))return o;i++}},configurable:!0,writable:!0});for(var oo,ao=function(){function e(e,t,n){var r=this;if(void 0===n&&(n=!1),this.config=void 0,this.configRefreshIntervalDefault=void 0,this.context=void 0,this.fallbackConfig=void 0,this.featureFlagUserId=void 0,this.initialized=void 0,this.libraryLanguage=void 0,this.storage=void 0,this.quickInit=void 0,this.globalWarnings=void 0,this.addStorageWarnings=function(){var e=[];return r.storage.warnings&&r.storage.warnings.length>0&&r.storage.warnings.map(function(t){e.push(t)}),e},this.targetingPropsToLowerCase=function(e){return Object.entries(e).reduce(function(e,t){var n,r=t[0],i=t[1];return"string"==typeof i&&(n=i.toLowerCase()),Array.isArray(i)&&(n=i.map(function(e){return e.toLowerCase()})),e[r.toLowerCase()]=n,e},{})},!e)throw new Error("Please provide a context object to the constructor.");if(!e.configUrl&&!t)throw new Error("Please provide either a config url or a valid config object.");this.config=void 0,this.configRefreshIntervalDefault=60,this.context=e,this.fallbackConfig=t,this.featureFlagUserId="",this.libraryLanguage="Javascript",this.initialized=!1,this.quickInit=n,this.storage=new Ui(e&&e.storageType?e.storageType:"",e.clientId),this.globalWarnings=[]}var t=e.prototype;return t.createHash=function(e,t){var n=(new io).create();return n.update(""+e+t),n.hex()},t.createUserId=function(){return Ci()},t.getUserFeatureIndex=function(e){return parseInt(e.substring(0,10),16).toString().slice(-2)},t.init=function(){try{var e,t=function(t){if(e)return t;if(a)return r;if(h)u.set("wmAppUserId",h);else{var i=u.get("wmAppUserId");i&&(n.context.userId=i)}if(!s){var o=u.get("wmFeatureFlagUserId");o&&(n.featureFlagUserId=o),o||(n.featureFlagUserId=n.createUserId(),u.set("wmFeatureFlagUserId",n.featureFlagUserId))}return(!n.context.userTargetingProperties||n.context.userTargetingProperties&&!n.context.userTargetingProperties.ffLibraryLanguage)&&n.updateContext(void 0,{ffLibraryLanguage:c}),n.initialized=!0,r},n=this,r=[],i=n.config,o=n.fallbackConfig,a=n.initialized,s=n.featureFlagUserId,c=n.libraryLanguage,u=n.storage,l=n.quickInit,d=n.context,f=d.configUrl,h=d.userId,p=d.configRefreshInterval,g=n.checkConfigCacheExpiry(void 0!==p?p:n.configRefreshIntervalDefault),v=function(){if(!i||g){var t=u.get("wmFeatureFlagConfig");try{t&&(n.config=JSON.parse(t))}catch(e){r.push({code:"FAILED_TO_READ_CONFIG_FROM_STORAGE",message:"There was a problem reading the config object from storage, possibly due to invalid config JSON."})}return function(){if(!t||g)return function(){if(f){!g&&o&&n.updateConfig(o);var i=u.get("wmFeatureFlagConfigEtag")||"-1";return i=t?i:"-1",Xi(function(){return l&&o?(t||n.updateConfig(o),n.loadAndSetRemoteConfig(f,i),e=1,r):(l&&!o&&r.push({code:"REMOTE_CONFIG_USED_NO_FALLBACK_PRESENT",message:"Remote config used because a fallback config is not present."}),Promise.resolve(n.loadAndSetRemoteConfig(f,i)).then(function(){}))},function(e){if(!t&&!o)throw new Error("Failed to load config file - no config url or default config provided. "+e);n.setNoNewConfigWarning()})}if(!o)throw new Error("Failed to load config file - no config url or default config provided.");n.updateConfig(o)}()}()}}();return Promise.resolve(v&&v.then?v.then(t):t(v))}catch(e){return Promise.reject(e)}},t.checkConfigCacheExpiry=function(e){var t,n=this.storage,r=new Date,i=function(e){return n.set("wmConfigCacheStart",e)},o=n.get("wmConfigCacheStart");if(!o){var a=new Date;i(JSON.stringify(a.getTime()))}var s=o?JSON.parse(o):r.getTime();if(1==(t=r.getTime()-s>e)){var c=new Date;i(JSON.stringify(c.getTime()))}return t},t.isFeatureEnabled=function(e){try{return Promise.resolve(this.queryFeatureFlag(e)).then(function(e){return e.enabled})}catch(e){return Promise.reject(e)}},t.setNoNewConfigWarning=function(){var e=this.fallbackConfig,t=this.storage.get("wmFeatureFlagConfig");t?this.globalWarnings.push({code:"CACHE_USED",message:Ni}):!t&&e&&(this.globalWarnings.push({code:"FALLBACK_USED_REMOTE_LOAD_FAILED",message:Ni}),this.updateConfig(e))},t.parseHeaders=function(e){return e.split("\r\n").reduce(function(e,t){var n=t.split(": ");return e[n[0]]=n[1],e},{})},t.loadAndSetRemoteConfig=function(e,t){try{var n=this,r=Xi(function(){return Promise.resolve(n.loadConfig(e,t)).then(function(e){if(e){n.config=e.data?e.data:n.config,e.data||n.globalWarnings.push({code:"FALLBACK_USED_REMOTE_LOAD_FAILED",message:"Fallback used because remote config loading failed."});var t=e.headers&&e.headers.etag?e.headers.etag:"";e.headers&&"string"==typeof e.headers&&(t=n.parseHeaders(e.headers).etag),t&&n.storage.set("wmFeatureFlagConfigEtag",t),n.storage.set("wmFeatureFlagConfig",JSON.stringify(n.config))}})},function(){n.globalWarnings.push({code:"FALLBACK_OR_CACHE_USED_REMOTE_LOAD_FAILED",message:"Fallback or cache used because remote config loading failed."}),n.setNoNewConfigWarning()});return Promise.resolve(r&&r.then?r.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},t.loadConfig=function(e,t){void 0===t&&(t="-1");try{var n,r=e+"?version=1",i={"If-None-Match":t},o=Xi(function(){return Promise.resolve(function(e){try{var t=Hr({"Content-Type":"application/json"},e.headers);return Promise.resolve(function(e,t){return t=t||{},new Promise(function(n,r){var i=new XMLHttpRequest,o=[],a=[],s={};for(var c in i.open(t.method||"get",e,!0),i.onload=function(){i.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(e,t,n){o.push(t=t.toLowerCase()),a.push([t,n]),s[t]=s[t]?s[t]+","+n:n}),n(function e(){return{ok:2==(i.status/100|0),statusText:i.statusText,status:i.status,url:i.responseURL,text:function(){return Promise.resolve(i.responseText)},json:function(){return Promise.resolve(i.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([i.response]))},clone:e,headers:{keys:function(){return o},entries:function(){return a},get:function(e){return s[e.toLowerCase()]},has:function(e){return e.toLowerCase()in s}}}}())},i.onerror=r,i.withCredentials="include"==t.credentials,t.headers)i.setRequestHeader(c,t.headers[c]);i.send(t.body||null)})}(e.url,{method:e.method,headers:t,body:xi(e)})).then(function(e){if(e.ok)return function(e){try{var t="";e.headers&&e.headers.entries().forEach(function(e){return t+=e[0]+": "+e[1]+"\r\n"});var n={status:e.status,statusText:e.statusText,headers:t,data:""},r=function(t,r){try{var i=Promise.resolve(e.json()).then(function(e){n.data=e})}catch(e){return}return i&&i.then?i.then(void 0,function(){}):i}();return Promise.resolve(r&&r.then?r.then(function(){return n}):n)}catch(e){return Promise.reject(e)}}(e);var t=new Error(e.statusText);return t.response=e,Promise.reject(t)})}catch(e){return Promise.reject(e)}}({url:r,method:"GET",headers:i})).then(function(e){n=e})},function(e){throw new Error("Failed to fetch config file: "+e)});return Promise.resolve(o&&o.then?o.then(function(e){return n}):n)}catch(e){return Promise.reject(e)}},t.updateConfig=function(e){this.config=e,this.storage.set("wmFeatureFlagConfig",JSON.stringify(e))},t.updateContext=function(e,t,n){var r=Hr({},this.context);if(e&&(r.userId=e),n)r.userTargetingProperties=t;else{var i=Hr({},r.userTargetingProperties,t);r.userTargetingProperties=i}this.context=r},t.getCohortConfig=function(e,t){var n={rolloutValue:"-1",cohortPriority:1,stickinessProperty:e.userId?"appUserId":"ffUserId"},r=[].concat(t);r.sort(function(e,t){return e.cohortPriority>t.cohortPriority?1:-1});var i=this.targetingPropsToLowerCase(e.userTargetingProperties),o=r.find(function(t){var n=!1;if(!e.userId&&"appUserId"===t.stickinessProperty)return!1;if(!t.cohortCriteria||t.cohortCriteria.length<1)return!0;for(var r=t.cohortCriteria,o=function(e){var t=r[e].requiredFieldName,o=r[e].requiredFieldValues;t=t.toLowerCase();var a=o.some(function(e){return e=e.toLowerCase(),!i.hasOwnProperty(t)&&""===e||("string"==typeof i[t]?i[t]===e:Array.isArray(i[t])?i[t].some(function(t){return t===e}):void 0)});if(!(n=a))return"break"},a=0;a<r.length&&"break"!==o(a);a++);return n});return o&&(n=Hr({},o)),n},t.cacheFlagResults=function(e){var t=this.storage,n=[],r=[],i=[];Array.isArray(e)?i=e?[].concat(e):[]:i.push(e);var o=t.get("wmFeatureFlagResults"),a=o?JSON.parse(o):[];(n=[].concat(a)).length>0&&(r=n.reduce(function(e,t){return i.find(function(e){return e.flagId===t.flagId})?e:[].concat(e,[t])},[]));var s=[].concat(r,i);return t.set("wmFeatureFlagResults",JSON.stringify(s)),s},t.checkIfFlagUpdated=function(e){var t=this.storage.get("wmFeatureFlagResults"),n=t?JSON.parse(t):[];if(n.length<1)return!0;var r=n.find(function(t){return t.flagId===e.flagId});return!r||r.enabled!==e.enabled},t.queryFeatureFlag=function(e,t){void 0===t&&(t=!1);try{var n,r,i,o,a,s,c=function(t){if(n)return t;var r=u.addStorageWarnings();p=g(r);var o={flagId:e,flagName:i,enabled:f,updatedSinceLastQuery:!0,clientId:l.clientId,userId:a,userIdType:h,warnings:p};return o.updatedSinceLastQuery=u.checkIfFlagUpdated(o),u.cacheFlagResults(o),o},u=this,l=u.context,d=u.fallbackConfig,f=!1,h="appUserId",p=[],g=function(e){return p.concat(e,t?[]:u.globalWarnings)},v=function(e,t){return e.flags.find(function(e){return e.id===t})},m=function(e,t){if(r=v(e,t)){var n=u.addStorageWarnings();p=g(n);var i={clientId:l.clientId,flagId:r.id,flagName:r.name?r.name:void 0,enabled:r.defaultValue,updatedSinceLastQuery:!0,warnings:p};return i.updatedSinceLastQuery=u.checkIfFlagUpdated(i),u.cacheFlagResults(i),i}},y=Xi(function(){return Promise.resolve(u.init()).then(function(c){if(p=c.concat(p),a=u.context.userId?u.context.userId:void 0,!u.config||!u.config.flags)throw new Error("Operation failed - no config file or invalid config file detected.");if(!(r=v(u.config,e))){if(d){var y=m(d,e);if(y)return p.push({code:"FALLBACK_USED_FLAG_NOT_IN_REMOTE",message:"Fallback used because a requested flag was present in it and not the remote."}),n=1,y}throw new Error("Flag not found")}var b=r.cohorts,w=r.defaultValue,S=r.name,I=r.type;if(I&&"boolean"!==I.toLowerCase()&&!t)throw new Error("Flag not found");if(!b||b.length<1){var E=u.addStorageWarnings();p=g(E);var T={clientId:l.clientId,flagId:r.id,flagName:S,enabled:r.defaultValue,updatedSinceLastQuery:!0,warnings:p};return T.updatedSinceLastQuery=u.checkIfFlagUpdated(T),u.cacheFlagResults(T),n=1,T}i=S;var P=u.getCohortConfig(l,b),_=P.rolloutValue;_=_||"0",o=u.context.userId?u.context.userId:void 0,"ffUserId"===P.stickinessProperty&&(h="ffUserId",o=a=u.featureFlagUserId);var k=o?u.createHash(o,r.id):void 0;if(s=k?u.getUserFeatureIndex(k):"-1",f=parseInt(s,10)<parseInt(_,10),parseInt(_,10)<0||parseInt(s,10)<0||parseInt(s,10)>99){if(void 0===w){if(d){var A=m(d,e);if(A)return n=1,A;throw new Error("Flag not found")}throw new Error("Unable to determine flag default value")}f=w}})},function(e){throw new Error("Failed to query feature flag: "+e)});return Promise.resolve(y&&y.then?y.then(c):c(y))}catch(e){return Promise.reject(e)}},t.queryAllFeatureFlags=function(){try{var e=this,t=e;return Promise.resolve(e.init()).then(function(){var n=e.config;if(!n||!n.flags)throw new Error("No config file or invalid config file detected.");var r={anyFlagsUpdatedSinceLastQuery:!1,globalWarnings:e.globalWarnings,results:[]},i=n.flags.map(function(e){try{return Promise.resolve(t.queryFeatureFlag(e.id,!0)).then(function(e){!0===e.updatedSinceLastQuery&&(r.anyFlagsUpdatedSinceLastQuery=!0),r.results.push(e)})}catch(e){return Promise.reject(e)}});return Promise.all(i).then(function(){return r})})}catch(e){return Promise.reject(e)}},e}(),so=256,co=[];so--;)co[so]=(so+256).toString(16).substring(1);for(var uo={__proto__:null,v4:function(){var e,t=0,n="";if(!oo||so+16>256){for(oo=Array(t=256);t--;)oo[t]=256*Math.random()|0;t=so=0}for(;t<16;t++)e=oo[so+t],n+=6==t?co[15&e|64]:8==t?co[63&e|128]:co[e],1&t&&t>1&&t<11&&(n+="-");return so++,n}},lo=Object.prototype.hasOwnProperty,fo=String.prototype.charAt,ho=Object.prototype.toString,po=function(e,t){return fo.call(e,t)},go=function(e,t){return lo.call(e,t)},vo=function(e,t){t=t||go;for(var n=[],r=0,i=e.length;r<i;r+=1)t(e,r)&&n.push(String(r));return n},mo=function(e){return null==e?[]:"[object String]"===ho.call(e)?vo(e,po):function(e){return null!=e&&"function"!=typeof e&&"number"==typeof e.length}(e)?vo(e,go):function(e,t){t=t||go;var n=[];for(var r in e)t(e,r)&&n.push(String(r));return n}(e)},yo=n(function(e){var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var n=new Uint8Array(16);e.exports=function(){return t(n),n}}else{var r=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}}),bo=[],wo=0;wo<256;++wo)bo[wo]=(wo+256).toString(16).substr(1);var So,Io,Eo=function(e,t){var n=t||0;return[bo[e[n++]],bo[e[n++]],bo[e[n++]],bo[e[n++]],"-",bo[e[n++]],bo[e[n++]],"-",bo[e[n++]],bo[e[n++]],"-",bo[e[n++]],bo[e[n++]],"-",bo[e[n++]],bo[e[n++]],bo[e[n++]],bo[e[n++]],bo[e[n++]],bo[e[n++]]].join("")},To=0,Po=0,_o=function(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||yo)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var o=0;o<16;++o)t[r+o]=i[o];return t||Eo(i)},ko=_o;ko.v1=function(e,t,n){var r=t&&n||0,i=t||[],o=(e=e||{}).node||So,a=void 0!==e.clockseq?e.clockseq:Io;if(null==o||null==a){var s=yo();null==o&&(o=So=[1|s[0],s[1],s[2],s[3],s[4],s[5]]),null==a&&(a=Io=16383&(s[6]<<8|s[7]))}var c=void 0!==e.msecs?e.msecs:(new Date).getTime(),u=void 0!==e.nsecs?e.nsecs:Po+1,l=c-To+(u-Po)/1e4;if(l<0&&void 0===e.clockseq&&(a=a+1&16383),(l<0||c>To)&&void 0===e.nsecs&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");To=c,Po=u,Io=a;var d=(1e4*(268435455&(c+=122192928e5))+u)%4294967296;i[r++]=d>>>24&255,i[r++]=d>>>16&255,i[r++]=d>>>8&255,i[r++]=255&d;var f=c/4294967296*1e4&268435455;i[r++]=f>>>8&255,i[r++]=255&f,i[r++]=f>>>24&15|16,i[r++]=f>>>16&255,i[r++]=a>>>8|128,i[r++]=255&a;for(var h=0;h<6;++h)i[r+h]=o[h];return t||Eo(i)},ko.v4=_o;var Ao=ko.v4,Oo={_data:{},length:0,setItem:function(e,t){return this._data[e]=t,this.length=mo(this._data).length,t},getItem:function(e){return e in this._data?this._data[e]:null},removeItem:function(e){return e in this._data&&delete this._data[e],this.length=mo(this._data).length,null},clear:function(){this._data={},this.length=0},key:function(e){return mo(this._data)[e]}},Co={defaultEngine:function(){try{if(!window.localStorage)return!1;var e=Ao();window.localStorage.setItem(e,"test_value");var t=window.localStorage.getItem(e);return window.localStorage.removeItem(e),"test_value"===t}catch(e){return!1}}()?window.localStorage:Oo,inMemoryEngine:Oo},xo=Object.prototype.toString,Ro="function"==typeof Array.isArray?Array.isArray:function(e){return"[object Array]"===xo.call(e)},Do=function(e,t){for(var n=0;n<t.length&&!1!==e(t[n],n,t);n+=1);},Mo=function(e,t){for(var n=mo(t),r=0;r<n.length&&!1!==e(t[n[r]],n[r],t);r+=1);},No=function(e,t){return(n=t,null!=n&&(Ro(n)||"function"!==n&&function(e){var t=typeof e;return"number"===t||"object"===t&&"[object Number]"===xo.call(e)}(n.length))?Do:Mo).call(this,e,t);var n},Uo=Co.defaultEngine,Fo=Co.inMemoryEngine,Lo=JSON;function jo(e,t,n,r){this.id=t,this.name=e,this.keys=n||{},this.engine=r||Uo,this.originalEngine=this.engine}jo.prototype.set=function(e,t){var n=this._createValidKey(e);if(n)try{this.engine.setItem(n,Lo.stringify(t))}catch(n){(function(e){var t=!1;if(e.code)switch(e.code){case 22:t=!0;break;case 1014:"NS_ERROR_DOM_QUOTA_REACHED"===e.name&&(t=!0)}else-2147024882===e.number&&(t=!0);return t})(n)&&(this._swapEngine(),this.set(e,t))}},jo.prototype.get=function(e){try{var t=this.engine.getItem(this._createValidKey(e));return null===t?null:Lo.parse(t)}catch(e){return null}},jo.prototype.getOriginalEngine=function(){return this.originalEngine},jo.prototype.remove=function(e){this.engine.removeItem(this._createValidKey(e))},jo.prototype._createValidKey=function(e){var t,n=this.name,r=this.id;return mo(this.keys).length?(No(function(i){i===e&&(t=[n,r,e].join("."))},this.keys),t):[n,r,e].join(".")},jo.prototype._swapEngine=function(){var e=this;No(function(t){var n=e.get(t);Fo.setItem([e.name,e.id,t].join("."),n),e.remove(t)},this.keys),this.engine=Fo};var Bo=jo,Wo={setTimeout:function(e,t){return window.setTimeout(e,t)},clearTimeout:function(e){return window.clearTimeout(e)},Date:window.Date},qo=Wo,Vo={ASAP:1,RESCHEDULE:2,ABANDON:3};function Jo(){this.tasks={},this.nextId=1}Jo.prototype.now=function(){return+new qo.Date},Jo.prototype.run=function(e,t,n){var r=this.nextId++;return this.tasks[r]=qo.setTimeout(this._handle(r,e,t,n||Vo.ASAP),t),r},Jo.prototype.cancel=function(e){this.tasks[e]&&(qo.clearTimeout(this.tasks[e]),delete this.tasks[e])},Jo.prototype.cancelAll=function(){No(qo.clearTimeout,this.tasks),this.tasks={}},Jo.prototype._handle=function(e,t,n,r){var i=this,o=i.now();return function(){if(delete i.tasks[e],!(r>=Vo.RESCHEDULE&&o+2*n<i.now()))return t();r===Vo.RESCHEDULE&&i.run(t,n,r)}},Jo.setClock=function(e){qo=e},Jo.resetClock=function(){qo=Wo},Jo.Modes=Vo;var zo=Jo,Ho=Ko;function Ko(e){return Ko.enabled(e)?function(t){t=Go(t);var n=new Date,r=n-(Ko[e]||n);Ko[e]=n,t=e+" "+t+" +"+Ko.humanize(r),window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}function Go(e){return e instanceof Error?e.stack||e.message:e}Ko.names=[],Ko.skips=[],Ko.enable=function(e){try{localStorage.debug=e}catch(e){}for(var t=(e||"").split(/[\s,]+/),n=t.length,r=0;r<n;r++)"-"===(e=t[r].replace("*",".*?"))[0]?Ko.skips.push(new RegExp("^"+e.substr(1)+"$")):Ko.names.push(new RegExp("^"+e+"$"))},Ko.disable=function(){Ko.enable("")},Ko.humanize=function(e){return e>=36e5?(e/36e5).toFixed(1)+"h":e>=6e4?(e/6e4).toFixed(1)+"m":e>=1e3?(e/1e3|0)+"s":e+"ms"},Ko.enabled=function(e){for(var t=0,n=Ko.skips.length;t<n;t++)if(Ko.skips[t].test(e))return!1;for(t=0,n=Ko.names.length;t<n;t++)if(Ko.names[t].test(e))return!0;return!1};try{window.localStorage&&Ko.enable(localStorage.debug)}catch(e){}var Qo,$o=n(function(e){function t(e){if(e)return function(e){for(var n in t.prototype)e[n]=t.prototype[n];return e}(e)}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},t.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t)}return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}}),Yo=((Qo=uo)&&Qo.default||Qo).v4,Xo=Ho("localstorage-retry");function Zo(e,t){return function(){return e.apply(t,arguments)}}function ea(e,t,n){"function"==typeof t&&(n=t),this.name=e,this.id=Yo(),this.fn=n,this.maxItems=t.maxItems||Infinity,this.maxAttempts=t.maxAttempts||Infinity,this.backoff={MIN_RETRY_DELAY:t.minRetryDelay||1e3,MAX_RETRY_DELAY:t.maxRetryDelay||3e4,FACTOR:t.backoffFactor||2,JITTER:t.backoffJitter||0},this.timeouts={ACK_TIMER:1e3,RECLAIM_TIMER:3e3,RECLAIM_TIMEOUT:1e4,RECLAIM_WAIT:500},this.keys={IN_PROGRESS:"inProgress",QUEUE:"queue",RECLAIM_START:"reclaimStart",RECLAIM_END:"reclaimEnd",ACK:"ack"},this._schedule=new zo,this._processId=0,this._store=new Bo(this.name,this.id,this.keys),this._store.set(this.keys.IN_PROGRESS,{}),this._store.set(this.keys.QUEUE,[]),this._ack=Zo(this._ack,this),this._checkReclaim=Zo(this._checkReclaim,this),this._processHead=Zo(this._processHead,this),this._running=!1}$o(ea.prototype),ea.prototype.start=function(){this._running&&this.stop(),this._running=!0,this._ack(),this._checkReclaim(),this._processHead()},ea.prototype.stop=function(){this._schedule.cancelAll(),this._running=!1},ea.prototype.shouldRetry=function(e,t){return!(t>this.maxAttempts)},ea.prototype.getDelay=function(e){var t=this.backoff.MIN_RETRY_DELAY*Math.pow(this.backoff.FACTOR,e);if(this.backoff.JITTER){var n=Math.random(),r=Math.floor(n*this.backoff.JITTER*t);Math.floor(10*n)<5?t-=r:t+=r}return Number(Math.min(t,this.backoff.MAX_RETRY_DELAY).toPrecision(1))},ea.prototype.addItem=function(e){this._enqueue({item:e,attemptNumber:0,time:this._schedule.now(),id:Yo()})},ea.prototype.requeue=function(e,t,n,r){this.shouldRetry(e,t,n)?this._enqueue({item:e,attemptNumber:t,time:this._schedule.now()+this.getDelay(t),id:r||Yo()}):this.emit("discard",e,t)},ea.prototype._enqueue=function(e){var t=this._store.get(this.keys.QUEUE)||[];(t=t.slice(-(this.maxItems-1))).push(e),t=t.sort(function(e,t){return e.time-t.time}),this._store.set(this.keys.QUEUE,t),this._running&&this._processHead()},ea.prototype._processHead=function(){var e=this,t=this._store;this._schedule.cancel(this._processId);var n=t.get(this.keys.QUEUE)||[],r=t.get(this.keys.IN_PROGRESS)||{},i=this._schedule.now(),o=[];function a(n,r){o.push({item:n.item,done:function(i,o){var a=t.get(e.keys.IN_PROGRESS)||{};delete a[r],t.set(e.keys.IN_PROGRESS,a),e.emit("processed",i,o,n.item),i&&e.requeue(n.item,n.attemptNumber+1,i,n.id)}})}for(var s=Object.keys(r).length;n.length&&n[0].time<=i&&s++<e.maxItems;){var c=n.shift(),u=Yo();r[u]={item:c.item,attemptNumber:c.attemptNumber,time:e._schedule.now()},a(c,u)}t.set(this.keys.QUEUE,n),t.set(this.keys.IN_PROGRESS,r),No(function(t){try{e.fn(t.item,t.done)}catch(e){Xo("Process function threw error: "+e)}},o),n=t.get(this.keys.QUEUE)||[],this._schedule.cancel(this._processId),n.length>0&&(this._processId=this._schedule.run(this._processHead,n[0].time-i,zo.Modes.ASAP))},ea.prototype._ack=function(){this._store.set(this.keys.ACK,this._schedule.now()),this._store.set(this.keys.RECLAIM_START,null),this._store.set(this.keys.RECLAIM_END,null),this._schedule.run(this._ack,this.timeouts.ACK_TIMER,zo.Modes.ASAP)},ea.prototype._checkReclaim=function(){var e=this;No(function(t){t.id!==e.id&&(e._schedule.now()-t.get(e.keys.ACK)<e.timeouts.RECLAIM_TIMEOUT||function(t){t.set(e.keys.RECLAIM_START,e.id),t.set(e.keys.ACK,e._schedule.now()),e._schedule.run(function(){t.get(e.keys.RECLAIM_START)===e.id&&(t.set(e.keys.RECLAIM_END,e.id),e._schedule.run(function(){t.get(e.keys.RECLAIM_END)===e.id&&t.get(e.keys.RECLAIM_START)===e.id&&e._reclaim(t.id)},e.timeouts.RECLAIM_WAIT,zo.Modes.ABANDON))},e.timeouts.RECLAIM_WAIT,zo.Modes.ABANDON)}(t))},function(t){for(var n=[],r=e._store.getOriginalEngine(),i=0;i<r.length;i++){var o=r.key(i).split(".");3===o.length&&o[0]===t&&"ack"===o[2]&&n.push(new Bo(t,o[1],e.keys))}return n}(this.name)),this._schedule.run(this._checkReclaim,this.timeouts.RECLAIM_TIMER,zo.Modes.RESCHEDULE)},ea.prototype._reclaim=function(e){var t=this,n=new Bo(this.name,e,this.keys),r={queue:this._store.get(this.keys.QUEUE)||[]},i={inProgress:n.get(this.keys.IN_PROGRESS)||{},queue:n.get(this.keys.QUEUE)||[]},o=[],a=function(e,n){No(function(e){var i=e.id||Yo();o.indexOf(i)>=0?t.emit("duplication",e.item,e.attemptNumber):(r.queue.push({item:e.item,attemptNumber:e.attemptNumber+n,time:t._schedule.now(),id:i}),o.push(i))},e)};a(i.queue,0),a(i.inProgress,1),r.queue=r.queue.sort(function(e,t){return e.time-t.time}),this._store.set(this.keys.QUEUE,r.queue),n.remove(this.keys.IN_PROGRESS),n.remove(this.keys.QUEUE),n.remove(this.keys.RECLAIM_START),n.remove(this.keys.RECLAIM_END),n.remove(this.keys.ACK),this._processHead()};var ta=ea,na=function(e,t,n){var r,i;return Ut&&"function"==typeof(r=t.constructor)&&r!==n&&m(i=r.prototype)&&i!==n.prototype&&Ut(e,i),e},ra=C.f,ia=we.f,oa=te.enforce,aa=ze("match"),sa=i.RegExp,ca=sa.prototype,ua=/a/g,la=/a/g,da=new sa(ua)!==ua,fa=Er.UNSUPPORTED_Y;if(a&&Ce("RegExp",!da||fa||o(function(){return la[aa]=!1,sa(ua)!=ua||sa(la)==la||"/a/i"!=sa(ua,"i")}))){for(var ha=function(e,t){var n,r=this instanceof ha,i=Pr(e),o=void 0===t;if(!r&&i&&e.constructor===ha&&o)return e;da?i&&!o&&(e=e.source):e instanceof ha&&(o&&(t=Sr.call(e)),e=e.source),fa&&(n=!!t&&t.indexOf("y")>-1)&&(t=t.replace(/y/g,""));var a=na(da?new sa(e,t):sa(e,t),r?this:ca,ha);return fa&&n&&(oa(a).sticky=!0),a},pa=function(e){e in ha||ra(ha,e,{configurable:!0,get:function(){return sa[e]},set:function(t){sa[e]=t}})},ga=ia(sa),va=0;ga.length>va;)pa(ga[va++]);ca.constructor=ha,ha.prototype=ca,ne(i,"RegExp",ha)}Wt("RegExp");var ma=Function.prototype,ya=ma.toString,ba=/^\s*function ([^ (]*)/;a&&!("name"in ma)&&(0,C.f)(ma,"name",{configurable:!0,get:function(){try{return ya.call(this).match(ba)[1]}catch(e){return""}}});var wa="[\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff]",Sa=RegExp("^"+wa+wa+"*"),Ia=RegExp(wa+wa+"*$"),Ea=function(e){return function(t){var n=String(g(t));return 1&e&&(n=n.replace(Sa,"")),2&e&&(n=n.replace(Ia,"")),n}},Ta={start:Ea(1),end:Ea(2),trim:Ea(3)},Pa=we.f,_a=k.f,ka=C.f,Aa=Ta.trim,Oa=i.Number,Ca=Oa.prototype,xa="Number"==f(gt(Ca)),Ra=function(e){var t,n,r,i,o,a,s,c,u=y(e,!1);if("string"==typeof u&&u.length>2)if(43===(t=(u=Aa(u)).charCodeAt(0))||45===t){if(88===(n=u.charCodeAt(2))||120===n)return NaN}else if(48===t){switch(u.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+u}for(a=(o=u.slice(2)).length,s=0;s<a;s++)if((c=o.charCodeAt(s))<48||c>i)return NaN;return parseInt(o,r)}return+u};if(Ce("Number",!Oa(" 0o1")||!Oa("0b1")||Oa("+0x1"))){for(var Da,Ma=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof Ma&&(xa?o(function(){Ca.valueOf.call(n)}):"Number"!=f(n))?na(new Oa(Ra(t)),n,Ma):Ra(t)},Na=a?Pa(Oa):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),Ua=0;Na.length>Ua;Ua++)S(Oa,Da=Na[Ua])&&!S(Ma,Da)&&ka(Ma,Da,_a(Oa,Da));Ma.prototype=Ca,Ca.constructor=Ma,ne(i,"Number",Ma)}var Fa=u.f,La=function(e){return function(t){for(var n,r=v(t),i=ct(r),o=i.length,s=0,c=[];o>s;)n=i[s++],a&&!Fa.call(r,n)||c.push(e?[n,r[n]]:r[n]);return c}},ja=[La(!0),La(!1)][0];Re({target:"Object",stat:!0},{entries:function(e){return ja(e)}});var Ba={lightningOrigin:"https://lightning.warnermediacdn.com",iFramePath:{DEV:"/cdptest/psmtk/getcdpid.html",TEST:"/cdptest/psmtk/getcdpid.html",PROD:"/cdp/psmtk/getcdpid.html",INTEGRATION:"/cdptest/psmtk/getcdpid.html",AUTOMATED_TEST:"/cdptest/psmtk/getcdpid.html"},thirdPartyCookie:"/cdp/psmtk/start.html",carouselScript:"/cdp/psm/assets/swiper/swiper-bundle.min.js",carouselStyles:"/cdp/psm/assets/swiper/swiper-bundle.min.css",locate:"https://geo.ngtv.io/locate",featureFlag:{DEV:"https://wmff.warnermediacdn.com/psm_2_dev_full.json",TEST:"https://wmff.warnermediacdn.com/psm_2_qa_full.json",PROD:"https://wmff.warnermediacdn.com/psm_2_prod_full.json",INTEGRATION:"https://wmff.warnermediacdn.com/psm_2_brand_integration_full.json",AUTOMATED_TEST:"https://wmff.warnermediacdn.com/psm_2_automated_test_full.json"},identity:{DEV:"https://dev.receive.wmcdp.io/v1/reg",TEST:"https://test.receive.wmcdp.io/v1/reg",PROD:"https://receive.wmcdp.io/v1/reg",INTEGRATION:"https://test.receive.wmcdp.io/v1/reg",AUTOMATED_TEST:"https://test.receive.wmcdp.io/v1/reg"},inbrain:{DEV:"https://dev.inbrain.wmcdp.io/v1/render",TEST:"https://test.inbrain.wmcdp.io/v1/render",PROD:"https://inbrain.wmcdp.io/v1/render",INTEGRATION:"https://test.inbrain.wmcdp.io/v1/render",AUTOMATED_TEST:"https://test.inbrain.wmcdp.io/v1/render"},idresolve:{DEV:"https://dev.psm.wmcdp.io/v1/resolve",TEST:"https://test.psm.wmcdp.io/v1/resolve",PROD:"https://psm.wmcdp.io/v1/resolve",INTEGRATION:"https://integration.psm.wmcdp.io/v1/resolve",AUTOMATED_TEST:"https://test.psm.wmcdp.io/v1/resolve"},logs:{DEV:"https://dev.receive.wmcdp.io/v1/reg",TEST:"https://test.receive.wmcdp.io/v1/reg",PROD:"https://receive.wmcdp.io/v1/reg",INTEGRATION:"https://test.receive.wmcdp.io/v1/reg",AUTOMATED_TEST:"https://test.receive.wmcdp.io/v1/reg"},authSvc:{DEV:"https://dev.token.wmcdp.io/v1/token",TEST:"https://test.token.wmcdp.io/v1/token",PROD:"https://token.wmcdp.io/v1/token",INTEGRATION:"https://test.token.wmcdp.io/v1/token",AUTOMATED_TEST:"https://test.token.wmcdp.io/v1/token"}},Wa=["US","PR","VI","UM",""],qa={"auth-service":!1,"doppler-identity-onstart":!0,"doppler-identity-oncomplete":!0,"doppler-session":!0,"doppler-privacy":!0,"doppler-telemetry":!0,"doppler-consent-update":!0,"doppler-heartbeat-event":!1,"doppler-pubsub-event":!1,"outside-us-location-check":!1,"doppler-send-logs":!0,"doppler-send-token-event":!1,idresolve:!1,sendAuthToken:!1,sendHHID:!1,inbrain:!1,isInAuthTokenExperiment:!1,isInHHIDExperiment:!1,sendWMSegs:!1,inBrainTemplateBeta:!1,inBrainRecommendationsBeta:!1,"test-enabled":!0,"test-disabled":!1},Va={minRetryDelay:3e4,maxRetryDelay:12e4,maxItems:5,maxAttempts:10,backoffFactor:2,backoffJitter:0},Ja=window,za=window,Ha=document;function Ka(){try{Ha.cookie="cookietest=1; SameSite=Strict;";var e=1!==Ha.cookie.indexOf("cookietest=");return Ha.cookie="cookietest=1; SameSite=Strict; expires=Thu, 01-Jan-1970 00:00:01 GMT",e}catch(e){return!1}}function Ga(){try{return!!za.localStorage}catch(e){return!0}}function Qa(){var e="__psm_test__";if(!Ga())return!1;try{return za.localStorage.setItem(e,e),za.localStorage.removeItem(e),!0}catch(e){return!1}}function $a(){var e=za,t="inner";"innerWidth"in za||(t="client",e=document.documentElement||document.body);var n=e[t+"Width"],r=e[t+"Height"];return n>=0&&r>=0?n+"x"+r:null}function Ya(){var e=document.documentElement,t=document.body,n=t?Math.max(t.offsetHeight,t.scrollHeight):0,r=Math.max(e.clientWidth,e.offsetWidth,e.scrollWidth),i=Math.max(e.clientHeight,e.offsetHeight,e.scrollHeight,n);return isNaN(r)||isNaN(i)?[0,0]:[r,i]}function Xa(e){var t="";if(e)return e;try{t=za.top.document.referrer}catch(e){if(za.parent)try{t=za.parent.document.referrer}catch(e){t=""}}return""===t&&(t=document.referrer),t}function Za(e,t){var n,r;return function i(){var o=[].slice.call(arguments),a=Date.now();n=clearTimeout(n),!r||a-r>=t?(e.apply(void 0,o),r=a):n=setTimeout(i.bind.apply(i,[null].concat(o)),t-(a-r))}}function es(e,t){var n=new RegExp("^[^#]*[?&]"+e+"=([^&#]*)").exec(t);return n?decodeURIComponent(n[1].replace(/\+/g," ")):null}var ts=function(e){var t,n;function r(t){var n,r=t.request,i=t.url,o=t.opts;return(n=e.call(this,r.responseText?r.responseText:"network failure")||this).context={url:i,code:r.status,headers:o.headers,method:o.method},n}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,r}(Yr(Error));function ns(e,t){return void 0===t&&(t={}),new Promise(function(n,r){var i=new XMLHttpRequest;for(var o in i.open(t.method||"get",e),i.onload=function(){if(2==(i.status/100|0))try{n(JSON.parse(i.responseText))}catch(e){n(i.responseText)}else r(new ts({request:i,url:e,opts:t}))},i.onerror=function(){r(new ts({request:i,url:e,opts:t}))},t.headers)i.setRequestHeader(o,t.headers[o]);i.send(t.body||null)})}var rs,is,os,as=window;function ss(e,t){var n,r;e.err?(n=e.err.toString(),r=e.err.stack):n=e.message;var i={brand:os.config.brand,device:{type:as.navigator.platform,userAgent:as.navigator.userAgent},eventName:t,eventProperties:{logMessage:n,method:e.methodName,featureFlagValues:os.getFlags(),stackTrace:r},eventType:"log",eventTimestamp:(new Date).toISOString(),library:{name:"PrismJS",version:"2.10.0",initConfig:os.config},platform:"web",session:os.session,wmukid:os.wmukid},o=Ga()&&"true"==as.localStorage.getItem("wmpsm_debug"),a=as.location.search.includes("wmpsm_debug");return"debug"!==t?o||a||"AUTOMATED_TEST"===is?"AUTOMATED_TEST"===is?console[t]("[PSM]: "+t+":",JSON.stringify(i.eventProperties)):console[t]("[PSM]: "+t+":",i):i.eventProperties.featureFlagValues["doppler-send-logs"]&&rs.addItem(i):(o||a||"AUTOMATED_TEST"===is)&&("AUTOMATED_TEST"===is?console.log("[PSM]: DEBUG",JSON.stringify(i.eventProperties)):console.log("[PSM]: DEBUG",i)),i}function cs(e){return ss(e,"info")}function us(e){return ss(e,"debug")}function ls(e){return ss(e,"error")}var ds=null,fs=window,hs=document,ps=it.some,gs=Tt("some");Re({target:"Array",proto:!0,forced:!gs},{some:function(e){return ps(this,e,arguments.length>1?arguments[1]:void 0)}});var vs,ms=window,ys=document,bs=[];ms.googletag=ms.googletag||{cmd:[]};var ws=function(){var e;-1!==ms.location.search.search(/[?&]wmpsm_debug=[1t]/)&&(e=console).log.apply(e,["[PSM]:"].concat([].slice.call(arguments)))},Ss=function(){return Math.round(Date.now()/1e3)},Is=function(e){bs.some(function(t){return e.slotId===t.slotId})||bs.push(e)};function Es(){bs.forEach(function(e){e.totalViewTime=0,e.adWasViewed=!1})}function Ts(e){var t=e.lastViewStarted,n=Ss();t&&(e.totalViewTime+=n-t),e.lastViewStarted=n}var Ps,_s=window,ks=document,As=["mousedown","mousemove","keydown"],Os=["scroll","focus"],Cs=(new Date).toISOString(),xs={totalTime:0,engagedTime:0,interval:30,maxScrollDepth:_s.scrollY,currentScrollPosition:_s.scrollY,didScrollUpDuringInterval:!1};function Rs(){var e=_s.scrollY,t=Ya()[1];e>xs.currentScrollPosition&&(xs.maxScrollDepth=e>=t?t:e),e<xs.currentScrollPosition&&(xs.didScrollUpDuringInterval=!0),xs.currentScrollPosition=e;var n=new Date;if(Ps){var r=Math.round((n.getTime()-Ps)/1e3);r<=3&&(xs.engagedTime+=r)}Ps=n.getTime()}function Ds(){var e=new Date,t=new Date(Cs);xs.totalTime=Math.round((e.getTime()-t.getTime())/1e3)}function Ms(){xs={totalTime:0,engagedTime:0,interval:30,maxScrollDepth:_s.scrollY,currentScrollPosition:_s.scrollY,didScrollUpDuringInterval:!1},Cs=(new Date).toISOString(),Ps=Date.now()}var Ns=window,Us=document;function Fs(){return"function"==typeof Ns.turner_getTransactionId?Ns.turner_getTransactionId():null}function Ls(){return Ka()?Ii.get("ug"):null}function js(){return Qa()?Ns.localStorage.getItem("kxkuid"):Ka()?Ii.get("kxkuid"):null}function Bs(){if(Ka()){var e=Ii.get("firstpartyuid");return e&&"object"==typeof e&&"id"in e?e.id:null}return null}function Ws(){var e=null;return Ka()&&(e=Ii.get("OptanonConsent")),e}function qs(){var e=Ii.get("s_ecid"),t=Ii.get("s_vi");return e||t||function(e){var t=Ii.get("AMCV_7FF852E2556756057F000101@AdobeOrg");if(t){var n=t.split("|"),r=n.indexOf("MCMID");if(-1!=r)return n[r+1]}return null}()}function Vs(){var e=null,t=null;if(Qa()&&(t=Ns.localStorage.getItem("zion.cnn_uid")))try{e=(t=JSON.parse(t)).id}catch(e){Ns.location.search.includes("wmpsm_debug")&&console.error("[PSM] Error parsing zion.cnn_uid to JSON")}return e}function Js(){if(Qa())for(var e=["Conviva/sdkConfig","Conviva.sdkConfig","top-player::Conviva.sdkConfig"],t=null,n=0;n<e.length;n++)if(t=Ns.localStorage.getItem(e[n]))try{return JSON.parse(t).clId}catch(e){Ns.location.search.includes("wmpsm_debug")&&console.error("[PSM] Error parsing Conviva ID to JSON")}return null}function zs(){var e=null;if(Ns.ZionMessageBus){var t=Ns.ZionMessageBus.getInstance().watching.id_found.messageQueue;if(t&&t instanceof Array){var n=t.find(function(e){var t,n=null==(t=e.message)?void 0:t.type;if("string"==typeof n)return"zaid"===n.toLowerCase()});e=n?n.message.value:null}}return e}function Hs(e,t){var n=null;if(e)for(var r,i=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Xr(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xr(e,void 0):void 0}}(e))){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}(e);!(r=i()).done;){var o=r.value;if("string"==typeof o){t&&(o=o.replace(/^data/,t));for(var a=o.match(/[^.[\]()]+/g),s=0;s<a.length;s++)if(0===s&&(n=Ns),"function"==typeof(n=n[a[s]])&&(n=n()),void 0===n){n=null;break}if(n)return n}}return n}function Ks(e,t){var n={};return e&&e[t]&&e[t].forEach(function(e){var r=Hs(e.staticLocations);r||(r=Hs(e.dynamicLocations,"psmPubSubData."+t)),n[e.name]=r}),n}var Gs,Qs,$s=function(e,t){var n=Ya();t.setPlatform(e.config.platform),t.addEntry("companyName","WarnerMedia"),t.setBrand(e.config.brand),t.setSubBrand(e.config.subBrand),t.setProductName(e.config.brand),t.setLibrary({name:"PrismJS",version:"2.10.0",initConfig:e.config}),t.setDevice({type:Ns.navigator.platform,userAgent:Ns.navigator.userAgent,totalWidth:n[0],totalHeight:n[1],screenResolution:za.screen.width+"x"+za.screen.height,viewportSize:$a()}),t.setNavigationProperties({url:Ns.location.href,rootDomain:pi(Ns.location.href),referrer:Xa(),path:Ns.location.pathname,search:Ns.location.search,title:Us.title}),t.setClientResolvedIp(e.location.ip_address),t.setLocation({city:e.location.states[0].cities[0],state:e.location.states[0].state,country:e.location.country,zip:e.location.states[0].zipcodes[0],timezone:Intl.DateTimeFormat().resolvedOptions().timeZone||null,locale:Ns.navigator.language,language:Ns.navigator.language.split("-")[0]||null}),t.setConsentProperties({uspString:Ii.get("usprivacy"),consentRule:e.consentRule,optanonConsent:Ws()}),t.setIABCategories({consentCategories:e.consentCategories}),t.setWMUKID(e.wmukid),t.setEventProperties({cookiesEnabled:Ka(),thirdPartyCookiesEnabled:ds,doNotTrack:!(!Ns.navigator.doNotTrack&&!Ns.doNotTrack),featureFlagValues:e.getFlags(),cookies:Ii.getAll(),automatedTest:"AUTOMATED_TEST"===e.config.psmEnvironment,heartbeat:xs,inbrain:Qs}),t.setSessionProperties(e.session),t.setAdsProperties({guid:Ls(),transid:Fs(),ads:bs}),t.setThirdPartyIds({attuuid:Bs(),cdpid:e.getCDPID(),cnnuid:Vs(),convivaid:Js(),ecid:qs(),kruxid:js(),liverampatsid:Ii.get("tok_lr"),wmhhid:Ii.get("wmhhid"),wminid:Ii.get("wminid"),zionid:zs(),hhidVersion:Ii.get("hhidVersion")}),t.setContentMetadata({page:Ks(e.config.contentMetadata,"page"),video:Ks(e.config.contentMetadata,"video")})},Ys=function(e,t){try{var n;function r(t){if(n)return t;if(o){var r,a=o.target,s=o.placement,c=o.html;(function(e){var t=e.pages;if(Xs.location.hostname!=e.domain)return!1;var n=[];try{t.forEach(function(e){var t=e.split("/"),r=window.location.pathname.split("/"),i=!0;r.forEach(function(e,n){"*"!=t[n]&&t[n]!=e&&(i=!1)}),n.push(i)})}catch(e){return ls({err:e,eventType:"inbrain",methodName:"shouldRender"}),!1}return-1!=n.indexOf(!0)})({domain:o.domain,pages:o.pages})&&(r=a,new Promise(function(e){var t=Zs.querySelector(r);t&&e(t),new MutationObserver(function(n,i){(t=Zs.querySelector(r))&&(e(t),i.disconnect())}).observe(Zs.documentElement,{childList:!0,subtree:!0})})).then(function(){var t;try{t=decodeURIComponent(c)}catch(e){return void ls({err:e,eventType:"inbrain",methodName:"initInbrainV2"})}switch(s){case"within":Zs.querySelector(a).innerHTML=t;break;case"before":Zs.querySelector(a).insertAdjacentHTML("beforebegin",t);break;case"after":Zs.querySelector(a).insertAdjacentHTML("afterend",t)}new Promise(function(e,t){var n=Zs.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=Ba.lightningOrigin+Ba.carouselStyles;var r=Zs.head.getElementsByTagName("link")[0];r&&r.parentElement?r.parentElement.insertBefore(n,r):Zs.head.appendChild(n);var i=Zs.createElement("script");i.type="text/javascript",i.src=Ba.lightningOrigin+Ba.carouselScript,i.addEventListener("load",function(){Xs.inbrainCarousel=new Swiper(".inbrain-carousel",{watchSlidesProgress:!0,slidesPerView:"auto",spaceBetween:20,navigation:{nextEl:".inbrain-control-next",prevEl:".inbrain-control-prev"}}),e(!0)}),Zs.head.appendChild(i)}).then(function(){ac({psm:e,env:i}),Xs.inbrainCarousel.on("slideChange",function(){ac({psm:e,env:i}),sc({psm:e,env:i})}),Xs.addEventListener("resize",function(){ac({psm:e,env:i})}),new IntersectionObserver(function(t,n){t.forEach(function(t){(t.isIntersecting||t.intersectionRatio>=.5)&&(sc({psm:e,env:i}),n.disconnect())})},{root:null,rootMargin:"0px",threshold:[0,.5,1]}).observe(Zs.querySelector(a))}),Zs.querySelectorAll("[data-inbrain]").forEach(function(t){var n=t.dataset.inbrain,r=t.dataset.slotindex,o=t.href;t.addEventListener("click",function(){ic({psm:e,id:n,promoPosition:r,destinationURL:o}),$s(e,Gs),Gs.trackInbrain("Inbrain Click",(new Date).toISOString(),function(e){rc({env:i,data:e})})})})})}}var i=e.config.psmEnvironment.toUpperCase();if(Gs=t,"Unknown"==e.wmukid)return Promise.resolve();if(!e.queryFlag("inbrain"))return Promise.resolve();nc("INBRAIN v2.0.4");var o=null,a=function(t,n){try{var r=Promise.resolve(ns(function(e,t){var n=Ii.get("wmhhid"),r=Ii.get("usprivacy"),i=e.getLocationProperties(),o=e.getDeviceProperties(),a=e.getIds(),s=Ba.inbrain[t];return s+="?wmukid="+encodeURIComponent(e.wmukid),s+="&cdpid="+encodeURIComponent(e.getCDPID()),s+="&url="+encodeURIComponent(window.location.href),s+="&usp="+encodeURIComponent(r),s+="&inBrainTemplateBeta="+e.queryFlag("inBrainTemplateBeta"),s+="&inBrainRecommendationsBeta="+e.queryFlag("inBrainRecommendationsBeta"),s+="&deviceType="+encodeURIComponent(o.type),s+="&location="+encodeURIComponent(i.state),s+="&language="+encodeURIComponent(i.language),s+="&ecid="+encodeURIComponent(a.ecid),s+="&kruxid="+encodeURIComponent(a.kruxid),a.attuuid&&(s+="&attuuid="+encodeURIComponent(a.attuuid)),n&&(s+="&wmhhid="+encodeURIComponent(n)),s}(e,i))).then(function(e){o=e})}catch(e){return n(e)}return r&&r.then?r.then(void 0,n):r}(0,function(e){ls({err:e,eventType:"inbrain",methodName:"initInbrain"}),n=1});return Promise.resolve(a&&a.then?a.then(r):r(a))}catch(e){return Promise.reject(e)}},Xs=window,Zs=document,ec=[],tc=[],nc=function(){var e;-1!==Xs.location.search.search(/[?&]wmpsm_debug=[1t]/)&&(e=console).log.apply(e,["[PSM]:"].concat([].slice.call(arguments)))};function rc(e){var t=e.env,n=e.data;try{ns(Ba.identity[t],{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})}catch(e){us({err:e,eventType:"inbrain",methodName:"sendEvent"})}}function ic(e){Qs={id:e.id,promoPosition:e.promoPosition,destinationURL:e.destinationURL,featureFlagValues:e.psm.getFlags()}}function oc(e){void 0===e&&(e=!1);var t=document.querySelectorAll(".swiper-slide-visible > div > a");if(e){var n=[];return t.forEach(function(e){n.push(e.dataset.inbrain)}),n}return t}function ac(e){var t=e.psm,n=e.env;oc().forEach(function(e){var r=e.dataset.inbrain;ec.includes(r)||(ic({psm:t,id:r}),$s(t,Gs),Gs.trackInbrain("Inbrain Promo Loaded",(new Date).toISOString(),function(e){rc({env:n,data:e})}),ec.push(r))})}function sc(e){var t=e.psm,n=e.env;oc().forEach(function(e){var r=e.dataset.inbrain;tc.includes(r)||(ic({psm:t,id:r}),$s(t,Gs),Gs.trackInbrain("Inbrain Promo Visible",(new Date).toISOString(),function(e){rc({env:n,data:e})}),tc.push(r))})}function cc(){var e={},t=function(t,n){null!=n&&""!==n&&(e[t]=n)};return{add:t,addMap:function(e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])},addJson:function(e,n){if(n&&function(e){if(!function(e){return null!=e&&(e.constructor==={}.constructor||e.constructor===[].constructor)}(e))return!1;for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!0;return!1}(n)){var r=JSON.stringify(n);t(e,r)}},build:function(){return e}}}var uc=window,lc=window,dc=document,fc=null;function hc(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}var pc=window,gc=pc.document,vc=new(function(){function e(){var e=this;this.ready=!1,this.config={platform:"web",brand:"",subBrand:"",psmEnvironment:void 0,cookieSameSite:"Lax",cookieSecure:!1,cookieExpires:31536e6},this.flags=[],this.location={asn:{id:"",name:""},continent:"",continentName:"",country:"",country_alpha2:"",country_alpha3:"",ip_address:"",lat:"",lon:"",proxy:null,states:[{cities:[],counties:[],state:"",zipcodes:[]}]},this.wmukid=null,this.cdpid=null,this.consentRule="Other",pc.WM=pc.WM||{},pc.WM.PSM=pc.WM.PSM||{},pc.WM.PSM.initPsm=this.initPsm.bind(this),pc.WM.PSM.getVersion=this.getVersion.bind(this),pc.WM.PSM.getWMUKID=this.getWMUKID.bind(this),pc.WM.PSM.getCDPID=this.getCDPID.bind(this),pc.WM.PSM.getConfig=this.getConfig.bind(this),pc.WM.PSM.getFlags=this.getFlags.bind(this),pc.WM.PSM.getAdsProperties=this.getAdsProperties.bind(this),pc.WM.PSM.getConsentProperties=this.getConsentProperties.bind(this),pc.WM.PSM.getBrand=this.getBrand.bind(this),pc.WM.PSM.getDeviceProperties=this.getDeviceProperties.bind(this),pc.WM.PSM.getIds=this.getIds.bind(this),pc.WM.PSM.getLibrary=this.getLibrary.bind(this),pc.WM.PSM.getLocationProperties=this.getLocationProperties.bind(this),pc.WM.PSM.getDeviceProperties=this.getDeviceProperties.bind(this),pc.WM.PSM.getNavigationProperties=this.getNavigationProperties.bind(this),pc.WM.PSM.getSessionProperties=this.getSessionProperties.bind(this),pc.WM.PSM.isDopplerIdentityOnStartEnabled=function(){return e.queryFlag("doppler-identity-onstart")},pc.WM.PSM.isDopplerIdentityOnCompleteEnabled=function(){return e.queryFlag("doppler-identity-oncomplete")},pc.WM.PSM.isDopplerPrivacyEnabled=function(){return e.queryFlag("doppler-privacy")},pc.WM.PSM.isDopplerTelemetryEnabled=function(){return e.queryFlag("doppler-telemetry")}}var t=e.prototype;return t.initPsm=function(e){try{var t=this,n=t;function r(){function n(){Ii.options({domain:t.config.cookieDomain,maxage:t.config.cookieExpires,path:"/",samesite:t.config.cookieSameSite,secure:t.config.cookieSecure}),t.browser=function(){var e=navigator.userAgent,t=e.indexOf("Safari")>-1&&-1===e.indexOf("Chrome")&&-1===e.indexOf("Chromium")&&-1===e.indexOf("CriOS")&&-1===e.indexOf("EdgiOS")&&-1===e.indexOf("FxiOS"),n=(e.indexOf("Firefox")>-1||e.indexOf("FxiOS")>-1)&&-1===e.indexOf("Seamonkey"),r=(e.indexOf("Chrome")>-1||e.indexOf("CriOS")>-1)&&-1===e.indexOf("Chromium")&&-1===e.indexOf("Edg")&&-1===e.indexOf("OPR"),i=e.indexOf("Edg")>-1;switch(!0){case t:return"safari";case n:return"firefox";case r:return"chrome";case i:return"edge";default:return"unknown"}}();var n="psmFFClient-"+t.config.brand+"-"+t.config.subBrand;t.ffClient=new ao({configUrl:Ba.featureFlag[e.psmEnvironment.toUpperCase()],configRefreshInterval:6e4,userTargetingProperties:{Platform:["Web"],Brand:[e.brand],Browser:t.browser,ClientID:n,CountryCode:t.countryCode},clientId:n});var r=hc(function(){return Promise.resolve(t.ffClient.queryAllFeatureFlags()).then(function(e){t.flags=e.results;var n=function(){if("US"===t.consentRule||"GDPR"===t.consentRule&&t.queryFlag("outside-us-location-check"))return Promise.resolve(o()).then(function(){})}();if(n&&n.then)return n.then(function(){})})},function(e){return ls({err:e,methodName:"queryAllFeatureFlags",eventType:"featureFlagging"}),Promise.resolve(o()).then(function(){})});if(r&&r.then)return r.then(function(){})}var r=hc(function(){return Promise.resolve((void 0===e&&(e={}),new Promise(function(t){"function"!=typeof Ja.__tcfapi&&t({shouldLoad:!1,categories:[]});var n=Object.assign({1:"data-store",3:"ads-person-prof",5:"content-person-prof",6:"consent-person",8:"measure-content",9:"measure-market",10:"product-develop"},e);Ja.__tcfapi("getTCData",2,function(e,r){if(r&&"purpose"in e&&"legitimateInterests"in e.purpose){var i=Object.assign({},e.purpose.legitimateInterests,e.purpose.consents),o=[],a=!0;Object.entries(n).forEach(function(e){var t,n,r=e[0],s=e[1];i[r]?o.push(((t={})[s]=i[r],t)):(o.push(((n={})[s]=!1,n)),a=!1)}),t({shouldLoad:a,categories:o.concat([{"special-purpose-1":!0},{"special-purpose-2":!0},{"feature-1":!0},{"feature-2":!0},{"feature-3":!0}])})}t({shouldLoad:!1,categories:[]})})}))).then(function(e){var n=e.shouldLoad,r=e.categories;Wa.includes(t.countryCode)?t.consentRule="US":n&&r.length>0&&(t.consentRule="GDPR"),t.consentCategories=r.reduce(function(e,t){return Object.assign({},e,t)},{})});var e},function(e){console.log("[PSM]: Error encountered during location check",e),t.consentCategories={}});return r&&r.then?r.then(n):n()}if(t.ready)return Promise.resolve();if(t.config=Object.assign(t.config,e),function(e){is=e.config.psmEnvironment?e.config.psmEnvironment.toUpperCase():"PROD",os=e,(rs=new ta("logger",Va,function(e,t){if(/bot|crawl|spider/i.test(as.navigator.userAgent))return t(null,{});e.ts=(new Date).toISOString(),ns(Ba.logs[is],{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(function(e){return t(null,e)}).catch(function(e){return t(e)})})).start()}(t),void 0===e){var i=new Error("[PSM]: Please provide a valid configuration to initPsm");throw ls({err:i,eventType:"configValidation",methodName:"initPsm"}),i}var o=function(){try{var r=e.psmEnvironment.toUpperCase(),i=(o={},s=function(e,t,n){e.addMap(function e(t){var n={};return Array.isArray(t)?t:(Object.entries(t).forEach(function(r){var i=r[0],o=r[1];o===Object(o)?n[i]=e(o):null!=o&&(n[i]=t[i])}),n)}(o)),e.add("eventTimestamp",function(e){return null==e||null==e?(new Date).toISOString():new Date(e).toISOString()}(t)),e.add("eventId",zr());try{n&&n(e.build())}catch(e){console.warn("[PSM]: error running custom callback")}return e},{addEntry:a=function(e,t){o[e]=t},setPlatform:function(e){a("platform",e)},setBrand:function(e){a("brand",e)},setSubBrand:function(e){a("subBrand",e)},setProductName:function(e){a("productName",e)},setWMUKID:function(e){a("wmukid",e)},setThirdPartyIds:function(e){a("ids",e)},setDevice:function(e){a("device",e)},setNavigationProperties:function(e){a("navigationProperties",e)},setClientResolvedIp:function(e){a("clientResolvedIp",e)},setLocation:function(e){a("location",e)},setConsentProperties:function(e){a("consentProperties",e)},setIABCategories:function(e){a("iabConsentCategories",e)},setLibrary:function(e){var t=window.WM,n=null==t?void 0:t.UserConsent,r=null;n&&(r={version:n.getVersion(),usingPsm:n.usingPSM(),initConfig:t.UserConsentConfig}),a("library",Object.assign({wmucLibrary:r},e))},setEventProperties:function(e){a("eventProperties",e)},setSessionProperties:function(e){a("session",e)},setAdsProperties:function(e){a("adsProperties",e)},setContentMetadata:function(e){a("contentMetadata",e)},trackAppLoad:function(e,t){var n=cc();return n.add("eventType","telemetry"),n.add("eventName","appLoad"),s(n,e,t)},trackHeartbeat:function(e,t){var n=cc();return n.add("eventType","telemetry"),n.add("eventName","heartbeat"),s(n,e,t)},trackPubSub:function(e,t,n){var r=cc();return r.add("eventType","telemetry"),r.add("eventName",e),a("eventProperties",{eventTrigger:"pubsub"}),s(r,t,n)},trackIdentityRegistration:function(e,t,n){var r=cc();return r.add("eventType","identity"),r.add("eventName",e),s(r,t,n)},trackTokenEvent:function(e,t,n){var r=cc();return r.add("eventType","token"),r.add("eventName",e),s(r,t,n)},trackConsentUpdated:function(e,t,n,r){var i=cc(),o={eventTrigger:e,uspString:null==t?void 0:t.usp,region:null==t?void 0:t.region};return i.add("eventType","privacy"),i.add("eventName","consent update"),a("eventProperties",o),s(i,n,r)},trackConsentGranted:function(e,t){var n=cc();return n.add("eventType","privacy"),n.add("eventName","ccpaShareData"),s(n,e,t)},trackConsentWithdrawn:function(e,t){var n=cc();return n.add("eventType","privacy"),n.add("eventName","ccpaShareData"),s(n,e,t)},trackPageExit:function(e,t,n){var r=cc();return r.add("eventType","telemetry"),r.add("eventName","pageExit"),r.add("eventTrigger",e),s(r,t,n)},trackInbrain:function(e,t,n){var r=cc();return r.add("eventType","telemetry"),r.add("eventName",e),s(r,t,n)}});return t.identityQueue=new ta("identity",Va,(c=Ba.identity[r],function(e,t){if(new RegExp(["bot","crawl","spider"].join("|"),"i").test(uc.navigator.userAgent))return t(null,{});e.sentAtTimestamp=(new Date).toISOString(),ns(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(function(e){return t(null,e)}).catch(function(n){us({err:n,methodName:"sendRequest",eventType:e.eventType||"queue"}),t(n)})})),pc.location!==window.parent.location?(console.log("[PSM]: Failing to load Prism from iFrame"),Promise.resolve()):Promise.resolve(function(e){try{return Promise.resolve(new Promise(function(t){var n=function(e){var t="",n="",r="";function i(e){return null!==e.match(/^[0-9A-F]{8}-[0-9A-F]{4}-[4][0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i)}function o(e,t){i(e)?(e=function(){var e=es("utm_term",fs.location.href),t=new RegExp(/cdpid_([0-9A-F]{8}-[0-9A-F]{4}-[4][0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12})/i).exec(e),n=null;return t&&(n=t[1]),n}()||e,Ii.set("CDPID",JSON.stringify({cdpId:e,wmukId:t}),{samesite:"None",secure:!0,encode:!1})):us({message:"CDPID value "+JSON.stringify(r)+" is invalid. Returning without updating",methodName:"updateCdpData",eventType:"cdpid"})}var a=hs.createElement("iframe");if(a.setAttribute("id","psm_thirdparty"),a.setAttribute("style","display:none"),a.setAttribute("src",Ba.lightningOrigin+Ba.thirdPartyCookie),hs.body.appendChild(a),fs.addEventListener("message",function(e){e.origin===Ba.lightningOrigin&&("PSM:3PCunsupported"===e.data?ds=!1:"PSM:3PCsupported"===e.data?ds=!0:(us({message:"Updating CDPID from iFrame value: "+JSON.stringify(e.data),methodName:"initIdentity",eventType:"message"}),o(e.data,n)))},!1),Ka()){t=Ii.get("WMUKID"),n=Ii.get("WMUKID_STABLE");var s=(r=Ii.get("CDPID"))&&"object"==typeof r&&"cdpId"in r&&i(r.cdpId);if(us({message:"[PSM]: Cookies enabled. Retrieving ID values\nWMUKID: "+JSON.stringify(t)+"\nWMUKID_STABLE: "+n+"\nCDPID: "+JSON.stringify(r)+"\n",methodName:"initIdentity",eventType:"identity"}),null==n&&us(null==t?{message:"WMUKID and WMUKID_STABLE cookies not found. Generating WMUKID_STABLE value: "+(n=zr()),methodName:"initIdentity",eventType:"identity"}:"object"==typeof t&&"id"in t?{message:"Legacy WMUKID value "+t.id+" found. Setting WMUKID_STABLE value: "+(n=t.id),methodName:"initIdentity",eventType:"identity"}:{message:"WMUKID string value "+t+" found. Setting WMUKID_STABLE value: "+(n=t),methodName:"initIdentity",eventType:"identity"}),us({message:"Setting WMUKID_STABLE cookie to "+n+". Cookie options: "+JSON.stringify(Ii.options()),methodName:"initIdentity",eventType:"identity"}),Ii.set("WMUKID_STABLE",n),null!==r&&s){if("object"==typeof r&&"cdpId"in r&&"wmukId"in r&&s){var c=r.cdpId;n!==r.wmukId?(us({message:"Updating CDPID value "+c+" with WMUKID: "+n,methodName:"initIdentity",eventType:"cdpid"}),o(c,n)):us({message:"CDPID cookie has already been set to value "+JSON.stringify(r)+". To start a new test, delete the CDPID cookie on this domain and lightning.warnermediacdn.com.",methodName:"initIdentity",eventType:"cdpid"})}}else if(null===function(e){var t,n=null;for(t=Ja;t;t=t.parent){try{if(t.frames&&t.frames.prism_toolkit){n=t;break}}catch(e){throw new Error(e)}if(t===Ja.top)break}return n}()){var u=hs.createElement("iframe");u.setAttribute("id","prism_toolkit"),u.setAttribute("style","display:none"),u.setAttribute("src",Ba.lightningOrigin+Ba.iFramePath[e]),hs.body.appendChild(u)}}return{wmukid:n,cdpid:r}}(e);if("AUTOMATED_TEST"===e)return t({wmukid:n.wmukid,cdpid:n.cdpid});var r=0;!function e(){if(n.cdpid=Ii.get("CDPID"),n.cdpid||r>=20)return t({wmukid:n.wmukid,cdpid:n.cdpid});r++,setTimeout(e,50)}()}))}catch(e){return Promise.reject(e)}}(r)).then(function(o){if(t.wmukid=o.wmukid,t.cdpid=o.cdpid,t.setSessionProperties(!0),t.resolveIds(),t.setSendAuthToken(),t.setSendHHIDCookie(),t.setIsInExperiment("isInAuthTokenExperiment"),t.setIsInExperiment("isInHHIDExperiment"),t.setSendWMSegs(),t.resolveAuthTokens(i),$s(t,i),pc.ZionMessageBus&&pc.ZionMessageBus.getInstance().publish("id_found",{type:"wmukid",value:t.wmukid}),i.trackIdentityRegistration("identity on page start",(new Date).toISOString(),function(e){t.queryFlag("doppler-identity-onstart")&&(t.identityQueue.addItem(e),t.resetNewSessionFields()),"AUTOMATED_TEST"===r&&pc.localStorage.setItem("payload-on-start",JSON.stringify(e))}),pc.addEventListener("load",function(){t.setSessionProperties(),$s(t,i),i.trackIdentityRegistration("identity on page complete",(new Date).toISOString(),function(e){t.queryFlag("doppler-identity-oncomplete")&&(t.identityQueue.addItem(e),"AUTOMATED_TEST"===r&&pc.localStorage.setItem("payload-on-complete",JSON.stringify(e)),t.resetNewSessionFields())})}),gc.addEventListener("userConsentChanged",function(e){us({message:"userConsentChanged event received",methodName:"initPsm",eventType:"privacy",context:{eventDetails:e.detail}}),t.setSessionProperties(),$s(t,i),i.trackConsentUpdated("userConsentChanged",e.detail,(new Date).toISOString(),function(e){t.queryFlag("doppler-consent-update")&&(us({message:"Consent Update event registered",methodName:"initPsm",eventType:"privacy",context:{payload:e}}),t.identityQueue.addItem(e),t.resetNewSessionFields())})}),t.queryFlag("doppler-heartbeat-event")&&(vs=new IntersectionObserver(function(e){e.forEach(function(e){var t=e.target.id,n=100*Math.round(e.intersectionRatio),r=e.boundingClientRect;e.isIntersecting?e.intersectionRatio>=.5&&function(e){var t=e.getBoundingClientRect();return e.contains(Ha.elementFromPoint(t.right-t.width/2,t.bottom-t.height/2))}(e.target)&&(ws("slotVisibilityChanged - "+t+" is in view. ("+n+"% in view)"),bs.forEach(function(e){e.slotId===t&&(e.visibleOnStart=!0,e.adWasViewed=!0,e.slotSize=r.width+"x"+r.height,Ts(e))})):(ws("slotVisibilityChanged - "+t+" is no longer in view. ("+n+"% in view)"),bs.forEach(function(e){e.slotId===t&&(e.visibleOnStart=!1,e.lastViewStarted=0)}))})},{root:null,rootMargin:"0px",threshold:[0,.5,1]}),ms.googletag.cmd.push(function(){ms.googletag.pubads().addEventListener("slotRenderEnded",function(e){var t=e.slot.getSlotElementId(),n=e.slot.getAdUnitPath(),r=ys.getElementById(t),i="0x0";e.size&&(i="string"==typeof e.size?e.size:e.size.join("x")),Is({slotId:t,slotSize:i,adUnitPath:n,totalViewTime:0,lastViewStarted:0,visibleOnStart:!1,adWasViewed:!1,rfv:e.slot.getTargeting("rfv")[0],creativeId:e.slot.getTargeting("creativeId")[0],lineItemId:e.slot.getTargeting("lineItemId")[0]}),r&&vs.observe(r)}),ms.googletag.pubads().addEventListener("slotVisibilityChanged",function(e){var t=e.slot.getSlotElementId();bs.forEach(function(n){n.slotId===t&&(n.rfv=e.slot.getTargeting("rfv")[0],n.creativeId=e.slot.getTargeting("creativeId")[0],n.lineItemId=e.slot.getTargeting("lineItemId")[0])})}),ms.googletag.pubads().getSlots().forEach(function(e){var t=e.getSlotElementId(),n=ys.getElementById(t),r={width:0,height:0};n&&(r=n.getBoundingClientRect()),Is({slotId:t,slotSize:r?Math.round(r.width)+"x"+Math.round(r.height):"0x0",adUnitPath:e.getAdUnitPath(),totalViewTime:0,lastViewStarted:0,visibleOnStart:!1,adWasViewed:!1,rfv:e.getTargeting("rfv")[0],creativeId:e.getTargeting("creativeId")[0],lineItemId:e.getTargeting("lineItemId")[0]}),n&&vs.observe(n)})}),ys.addEventListener("inbrain.loaded",function(e){e.detail.forEach(function(e){var t=ys.getElementById(e);if(t){var n=t.getBoundingClientRect();Is({slotId:e,slotSize:n?Math.round(n.width)+"x"+Math.round(n.height):"0x0",totalViewTime:0,lastViewStarted:0,visibleOnStart:!1,adWasViewed:!1}),vs.observe(t)}})}),As.forEach(function(e){ks.addEventListener(e,Za(Rs,1e3))}),Os.forEach(function(e){_s.addEventListener(e,Za(Rs,1e3))}),"Unknown"!==t.wmukid)&&(function(e,n){dc.addEventListener("visibilitychange",function(){"hidden"===dc.visibilityState?(bs.forEach(function(e){e.visibleOnStart&&(e.lastViewStarted=0);var t=ys.getElementById(e.slotId);t&&vs.unobserve(t)}),lc.clearInterval(fc),fc=null,Ds(),$s(t,i),i.trackPageExit("visibilitychange",(new Date).toISOString(),function(e){e.sentAtTimestamp=(new Date).toISOString(),pc.navigator.sendBeacon(Ba.identity[r],JSON.stringify(e))})):(bs.forEach(function(e){e.visibleOnStart&&(e.lastViewStarted=Ss());var t=ys.getElementById(e.slotId);t&&vs.observe(t)}),Es(),Ms(),fc=fc||lc.setInterval(e,3e4))},!1),fc=lc.setInterval(e,3e4)}(function(){bs.forEach(function(e){e.visibleOnStart&&Ts(e)}),Ds(),t.setSessionProperties(),$s(t,i),i.trackHeartbeat((new Date).toISOString(),function(e){t.identityQueue.addItem(e),t.resetNewSessionFields(),Ms(),Es()})}),pc.addEventListener("beforeunload",function(){Ds(),$s(t,i),i.trackPageExit("beforeunload",(new Date).toISOString(),function(e){e.sentAtTimestamp=(new Date).toISOString(),pc.navigator.sendBeacon(Ba.identity[r],JSON.stringify(e))})}),pc.addEventListener("pagehide",function(e){e.persisted||(Ds(),$s(t,i),i.trackPageExit("pagehide",(new Date).toISOString(),function(e){e.sentAtTimestamp=(new Date).toISOString(),pc.navigator.sendBeacon(Ba.identity[r],JSON.stringify(e))}))})),t.queryFlag("doppler-pubsub-event")){var a=function(t){e.topics[t].forEach(function(e){pc.PubSub&&pc.PubSub.subscribe(e,function(){var r=[].slice.call(arguments),o="object"==typeof r[1]?r[1]:r[0];o=Object.keys(o).length<3&&o.video?o.video:o,pc.psmPubSubData=pc.psmPubSubData||{},pc.psmPubSubData[t]=pc.psmPubSubData[t]||{},Object.assign(pc.psmPubSubData[t],o),$s(n,i),i.trackPubSub(e,(new Date).toISOString(),function(e){n.identityQueue.addItem(e),n.resetNewSessionFields()})})})};for(var s in e.topics)a(s)}t.identityQueue.start();try{Ys(t,i)}catch(e){ls({err:e,eventType:"inbrain",methodName:"initInbrain"})}t.ready=!0})}catch(e){return Promise.reject(e)}var o,a,s,c};t.validateConfig(e),t.countryCode=t.hasProperty("countryCode",e)&&void 0!==e.countryCode&&t.config.countryCode.length?t.config.countryCode.toUpperCase():"";var a=function(){if(Wa.includes(t.countryCode)||""===t.countryCode){var e=hc(function(){return Promise.resolve(ns(Ba.locate)).then(function(e){t.location=e,t.countryCode=""===t.countryCode?t.location.country_alpha2:t.countryCode})},function(e){ls({err:e,methodName:"sendRequest",eventType:"geolocation"}),t.location.country=void 0,t.location.country_alpha2=void 0});if(e&&e.then)return e.then(function(){})}}();return Promise.resolve(a&&a.then?a.then(r):r())}catch(e){return Promise.reject(e)}},t.setSendHHIDCookie=function(){var e=this.queryFlag("sendHHID");return Ii.set("sendHHID",e)},t.setSendAuthToken=function(){var e=this.queryFlag("sendAuthToken");return Ii.set("sendAuthToken",e)},t.setIsInExperiment=function(e){var t=this.queryFlag(e);return Ii.set(e,t)},t.setSendWMSegs=function(){var e=this.queryFlag("sendWMSegs");return Ii.set("sendWMSegs",e)},t.resolveIds=function(){try{var e=this;function t(){return Ii.set("idrTimestamp",new Date),!0}if(!e.queryFlag("idresolve"))return us({message:"[PSM]: idresolve flag is disabled",methodName:"resolveIds",eventType:"idresolution"}),Promise.resolve(!1);var n=Ii.get("idrTimestamp");if(n){var r=new Date(n),i=((new Date).getTime()-r.getTime())/1e3/60/60;if(i<24)return cs({message:"[PSM]: IDR lifespan, "+i+", less than 24 hours",methodName:"resolveIds",eventType:"idresolution"}),Promise.resolve(!1)}var o={wmukid:e.getWMUKID(),ids:{attuuid:Bs(),cdpid:e.getCDPID(),cnnuid:Vs(),convivaid:Js(),ecid:qs(),kruxid:js(),wmhhid:Ii.get("wmhhid"),wminid:Ii.get("wminid"),zionid:zs()}},a=hc(function(){return Promise.resolve(ns(Ba.idresolve[e.config.psmEnvironment],{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).then(function(e){var t=e.wmhhid,n=e.wminid,r=e.wmsegs,i=e.hhidVersion;t||Ii.remove("wmhhid"),r||localStorage.removeItem("wmsegs"),t&&Ii.set("wmhhid",t),i&&Ii.set("hhidVersion",i.toString()),n&&Ii.set("wminid",n),r&&localStorage.setItem("wmsegs",r)})},function(e){us({err:e,eventType:"idresolution",methodName:"sendRequest"})});return Promise.resolve(a&&a.then?a.then(t):t())}catch(e){return Promise.reject(e)}},t.resolveAuthTokens=function(e){try{var t,n,r,i,o=this;function a(){return o.setSessionProperties(),$s(o,e),d&&e.trackTokenEvent("new token",(new Date).toISOString(),function(e){o.queryFlag("doppler-send-token-event")&&(o.identityQueue.addItem(e),o.resetNewSessionFields())}),f&&e.trackTokenEvent("token updated",(new Date).toISOString(),function(e){o.queryFlag("doppler-send-token-event")&&(o.identityQueue.addItem(e),o.resetNewSessionFields())}),Ii.set("resolveAuthTimestamp",new Date),!0}if(!o.queryFlag("auth-service"))return us({message:"[PSM]: auth-service flag is disabled",methodName:"resolveAuthTokens",eventType:"authService"}),Promise.resolve(!1);var s,c,u,l,d=!0,f=!1,h=Ii.get("resolveAuthTimestamp");if(h){var p=new Date(h),g=(Date.now()-p.getTime())/1e3/60/60;if(g<24)return cs({message:"Resolve Auth Token lifespan, "+g+", less than 24 hours",methodName:"resolveAuthTokens",eventType:"authService"}),Promise.resolve(!1)}var v=Ii.get("tok_lr"),m=Ii.get("_lr_env"),y=m||v;y&&(s={provider:"Liveramp ATS",details:{id:y}},d=!1,f=!0);var b=es("bt_ts",pc.location.href),w=es("utm_term",pc.location.href);if(b&&w){var S=(Date.now()-parseInt(b))/1e3/60/60;if(S>24)return cs({message:"bt_ts Parameter lifespan, "+S+", greater than 24 hours",methodName:"resolveAuthTokens",eventType:"authService"}),Promise.resolve(!1);c={provider:"zeta",details:{id:w}}}var I=es("primo",pc.location.href);I&&(u={provider:"braze",details:{id:I}});var E=Vs();if(E&&(l={provider:"cnnAuthentication",details:{id:E}}),!(y||w&&b||I||E))return us({message:"[PSM]: No token information present",methodName:"resolveAuthTokens",eventType:"authService"}),Promise.resolve(!1);var T=[];(null==(t=s)?void 0:t.provider)&&T.push(s),(null==(n=c)?void 0:n.provider)&&T.push(c),(null==(r=u)?void 0:r.provider)&&T.push(u),(null==(i=l)?void 0:i.provider)&&T.push(l);var P={wmukid:o.getWMUKID(),brand:o.config.brand,ids:{attuuid:Bs(),cdpid:o.getCDPID(),convivaid:Js(),ecid:qs(),kruxid:js(),wmhhid:Ii.get("wmhhid"),wminid:Ii.get("wminid"),zionid:zs()},consentProperties:{usp:Ii.get("usprivacy")},authentication:T},_=hc(function(){return Promise.resolve(ns(Ba.authSvc[o.config.psmEnvironment],{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(P)})).then(function(e){var t=e.tokens.filter(function(e){return"liveramp"===e.provider})[0];Ii.set("tok_lr",t.token,{expires:new Date(t.expiration)}),m&&!v&&Ii.remove("_lr_env")})},function(e){us({err:e,eventType:"authService",methodName:"resolveAuthTokens"})});return Promise.resolve(_&&_.then?_.then(a):a())}catch(e){return Promise.reject(e)}},t.getPageLoadId=function(e,t){var n=Ii.get("psmPageLoadId"),r=n&&parseInt(n),i=r;return e&&(i=1),!e&&t&&r&&(i=r+1),i},t.setSessionProperties=function(e){void 0===e&&(e=!1);var t=new Date,n={isSessionStart:!0,pageloadid:this.getPageLoadId(!0,e),psmLastActiveTimestamp:t.toISOString(),psmSessionStart:t.toISOString(),sessionDuration:0,sessionid:zr()},r=Ii.get("psmSessionId"),i=Ii.get("psmSessionStart"),o=Ii.get("psmLastActiveTimestamp");if(null!==r){var a=new Date(o),s=new Date(i),c=t.getTime()-a.getTime();c>18e5?(cs({message:"[PSM]: Session "+r+" timed out after "+c/1e3+" seconds.",methodName:"setSessionProperties",eventType:"session"}),n=Object.assign({},n,{previousSession:{psmLastActiveTimestamp:o,psmSessionStart:i,sessionDuration:(a.getTime()-s.getTime())/1e3,sessionid:r}})):(us({message:"[PSM]: Session "+r+" still active after "+c/1e3+" seconds. Updating last active timestamp.",methodName:"setSessionProperties",eventType:"session"}),n={isSessionStart:!1,pageloadid:this.getPageLoadId(!1,e),psmLastActiveTimestamp:t.toISOString(),psmSessionStart:i,sessionDuration:(t.getTime()-s.getTime())/1e3,sessionid:r})}else cs({message:"[PSM]: Creating new session",methodName:"setSessionProperties",eventType:"session"});Ii.set("psmSessionId",n.sessionid),Ii.set("psmLastActiveTimestamp",n.psmLastActiveTimestamp),Ii.set("psmSessionStart",n.psmSessionStart),Ii.set("psmPageLoadId",JSON.stringify(n.pageloadid)),this.session=n},t.resetNewSessionFields=function(){this.session=Object.assign({},this.session,{isSessionStart:!1,previousSession:null})},t.getVersion=function(){return"2.10.0"},t.getWMUKID=function(){return Ii.get("WMUKID_STABLE")||"Unknown"},t.getCDPID=function(){var e=Ii.get("CDPID");return e&&"object"==typeof e&&"cdpId"in e&&"wmukId"in e?e.cdpId:e||"Unknown"},t.getConfig=function(){return this.config},t.getFlags=function(){return this.flags.reduce(function(e,t){var n;return Object.assign({},e,((n={})[t.flagId]=t,n))},{})},t.getAdsProperties=function(){return{guid:Ls()||"",transid:Fs()||"",ads:bs}},t.getConsentProperties=function(){return{uspString:Ii.get("usprivacy"),consentRule:this.consentRule,optanonConsent:Ws()||""}},t.getBrand=function(){return this.config.brand},t.getDeviceProperties=function(){return{type:pc.navigator.platform,userAgent:pc.navigator.userAgent}},t.getIds=function(){return{attuuid:Bs()||"",cdpid:this.getCDPID(),cnnuid:Vs()||"",convivaid:Js()||"",ecid:qs()||"",kruxid:js()||"",liverampatsid:Ii.get("tok_lr"),wmhhid:Ii.get("wmhhid"),wminid:Ii.get("wminid"),zionid:zs()||""}},t.getLibrary=function(){return{name:"Prism JS",version:"2.10.0",initConfig:this.config}},t.getLocationProperties=function(){return{city:this.location.states[0].cities[0],state:this.location.states[0].state,country:this.location.country,zip:this.location.states[0].zipcodes[0],timezone:Intl.DateTimeFormat().resolvedOptions().timeZone||null,locale:pc.navigator.language,language:pc.navigator.language.split("-")[0]||null}},t.getNavigationProperties=function(){return{url:pc.location.href,rootDomain:pi(pc.location.href),referrer:Xa(),path:pc.location.pathname,search:pc.location.search,title:gc.title}},t.getSessionProperties=function(){return this.session},t.queryFlag=function(e){var t=qa[e]||!1;try{t=this.flags.find(function(t){return t.flagId===e}).enabled}catch(e){ss({err:e,methodName:"queryFlag",eventType:"featureFlagging"},"warn")}return t},t.validateConfig=function(e){var t=[];if(this.hasProperty("psmEnvironment",e)||t.push("Please specify your psmEnvironment."),this.hasProperty("brand",e)||t.push("Please specify your brand."),t.length){var n=new Error(["[PSM]: Invalid configuration provided."].concat(t).join("\n"));throw ls({err:n,methodName:"validateConfig",eventType:"configValidation"}),n}},t.hasProperty=function(e,t){return Object.prototype.hasOwnProperty.call(t,e)},e}());e.psm=vc});
//# sourceMappingURL=psm.legacy.min.umd.js.map
